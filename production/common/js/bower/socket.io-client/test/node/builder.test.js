/*!
 * socket.io-node
 * Copyright(c) 2011 LearnBoost <dev@learnboost.com>
 * MIT Licensed
 */

var builder=null,common=null,should=null;module.exports={"version number":function(){builder.version.should().match(/([0-9]+)\.([0-9]+)\.([0-9]+)/),builder.version.should().equal(null.version)},"production build LOC":function(){builder(function(n,o){should.strictEqual(n,null);var l=o.split("\n");l.length.should().be.below(5),l[0].should().match(/production/gi),Buffer.byteLength(o).should().be.below(43e3)})},"development build LOC":function(){builder({minify:!1},function(n,o){should.strictEqual(n,null);var l=o.split("\n");l.length.should().be.above(5),l[0].should().match(/development/gi),Buffer.byteLength(o).should().be.above(35e3)})},"default builds":function(){builder(function(n,o){should.strictEqual(n,null);var l=common.execute(o).io,e=Object.keys(l.Transport),u=Object.keys(builder.transports);e.length.should().be.equal(u.length+1),u.forEach(function(n){e.indexOf(n).should().be.above(-1)})})},"custom build":function(){builder(["websocket"],function(n,o){should.strictEqual(n,null);var l=common.execute(o).io,e=Object.keys(l.Transport);e.should().have.length(1),e[0].should().eql("websocket")})},"custom code":function(){var n='var hello = "world";';builder({custom:[n],minify:!1},function(o,l){should.strictEqual(o,null),l.should().include.string(n)})},"node if":function(){var n='// if node \nvar hello = "world";\n// end node\nvar pew = "pew";';builder({custom:[n],minify:!1},function(o,l){should.strictEqual(o,null),l.should().not.include.string(n),l.should().not.include.string("// if node"),l.should().not.include.string("// end node"),l.should().not.include.string('"world"'),l.should().include.string('var pew = "pew"')})},"preserve the encoding during minification":function(){builder(function(n,o){should.strictEqual(n,null),o.should().match(/(\\ufffd)/g)})},globals:function(){builder(function(n,o){should.strictEqual(n,null);var l=common.execute(o),e=common.env(),u=["io","swfobject","WEB_SOCKET_DISABLE_AUTO_INITIALIZATION"];Array.prototype.push.apply(u,Object.keys(e)),Object.keys(l).forEach(function(n){var o=u.indexOf(n);if(!~o)throw Error("Global leak: "+n)})})}};