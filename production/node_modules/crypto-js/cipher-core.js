!function(e,t){"object"==typeof exports?module.exports=exports=t(require("./core")):"function"==typeof define&&define.amd?define(["./core"],t):t(e.CryptoJS)}(this,function(e){e.lib.Cipher||function(t){var r,i,n,c,o,s,a,f,p,d,h,u,l,_,y,v,x=e,g=x.lib,k=g.Base,m=g.WordArray,S=g.BufferedBlockAlgorithm,B=x.enc;B.Utf8,r=B.Base64,i=x.algo,n=i.EvpKDF,c=g.Cipher=S.extend({cfg:k.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,r){this.cfg=this.cfg.extend(r),this._xformMode=e,this._key=t,this.reset()},reset:function(){S.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){e&&this._append(e);var t=this._doFinalize();return t},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?v:l}return function(t){return{encrypt:function(r,i,n){return e(i).encrypt(t,r,i,n)},decrypt:function(r,i,n){return e(i).decrypt(t,r,i,n)}}}}()}),g.StreamCipher=c.extend({_doFinalize:function(){var e=this._process(!0);return e},blockSize:1}),o=x.mode={},s=g.BlockCipherMode=k.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),a=o.CBC=function(){function e(e,r,i){var n,c,o=this._iv;for(o?(n=o,this._iv=t):n=this._prevBlock,c=0;i>c;c++)e[r+c]^=n[c]}var r=s.extend();return r.Encryptor=r.extend({processBlock:function(t,r){var i=this._cipher,n=i.blockSize;e.call(this,t,r,n),i.encryptBlock(t,r),this._prevBlock=t.slice(r,r+n)}}),r.Decryptor=r.extend({processBlock:function(t,r){var i=this._cipher,n=i.blockSize,c=t.slice(r,r+n);i.decryptBlock(t,r),e.call(this,t,r,n),this._prevBlock=c}}),r}(),f=x.pad={},p=f.Pkcs7={pad:function(e,t){var r,i,n,c,o,s;for(r=4*t,i=r-e.sigBytes%r,n=i<<24|i<<16|i<<8|i,c=[],o=0;i>o;o+=4)c.push(n);s=m.create(c,i),e.concat(s)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},g.BlockCipher=c.extend({cfg:c.cfg.extend({mode:a,padding:p}),reset:function(){var e,t,r,i;c.reset.call(this),e=this.cfg,t=e.iv,r=e.mode,this._xformMode==this._ENC_XFORM_MODE?i=r.createEncryptor:(i=r.createDecryptor,this._minBufferSize=1),this._mode=i.call(r,this,t&&t.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e,t=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),t.unpad(e)),e},blockSize:4}),d=g.CipherParams=k.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),h=x.format={},u=h.OpenSSL={stringify:function(e){var t,i=e.ciphertext,n=e.salt;return t=n?m.create([1398893684,1701076831]).concat(n).concat(i):i,t.toString(r)},parse:function(e){var t,i=r.parse(e),n=i.words;return 1398893684==n[0]&&1701076831==n[1]&&(t=m.create(n.slice(2,4)),n.splice(0,4),i.sigBytes-=16),d.create({ciphertext:i,salt:t})}},l=g.SerializableCipher=k.extend({cfg:k.extend({format:u}),encrypt:function(e,t,r,i){i=this.cfg.extend(i);var n=e.createEncryptor(r,i),c=n.finalize(t),o=n.cfg;return d.create({ciphertext:c,key:r,iv:o.iv,algorithm:e,mode:o.mode,padding:o.padding,blockSize:e.blockSize,formatter:i.format})},decrypt:function(e,t,r,i){i=this.cfg.extend(i),t=this._parse(t,i.format);var n=e.createDecryptor(r,i).finalize(t.ciphertext);return n},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),_=x.kdf={},y=_.OpenSSL={execute:function(e,t,r,i){i||(i=m.random(8));var c=n.create({keySize:t+r}).compute(e,i),o=m.create(c.words.slice(t),4*r);return c.sigBytes=4*t,d.create({key:c,iv:o,salt:i})}},v=g.PasswordBasedCipher=l.extend({cfg:l.cfg.extend({kdf:y}),encrypt:function(e,t,r,i){var n,c;return i=this.cfg.extend(i),n=i.kdf.execute(r,e.keySize,e.ivSize),i.iv=n.iv,c=l.encrypt.call(this,e,t,n.key,i),c.mixIn(n),c},decrypt:function(e,t,r,i){var n,c;return i=this.cfg.extend(i),t=this._parse(t,i.format),n=i.kdf.execute(r,e.keySize,e.ivSize,t.salt),i.iv=n.iv,c=l.decrypt.call(this,e,t,n.key,i)}})}()});