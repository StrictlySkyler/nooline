function check(){resolved===count&&(normalize(),display())}function makeBar(t){for(var o="";o.length<t;)o+="=";return o}function normalize(){var t,o=0,n=0;for(t=0;count>t;t++)o=Math.max(o,outputs[t].gzip),n=Math.max(n,outputs[t].original);for(t=0;count>t;t++)outputs[t].bargraph=makeBar(80*(outputs[t].gzip/o)),outputs[t].bargraph2=makeBar(80*(outputs[t].original/n))}function display(){var t;for(t=0;count>t;t++)console.log(outputs[t].version+" "+outputs[t].gzip+" "+outputs[t].original),console.log("gzip "+outputs[t].bargraph),console.log("orig "+outputs[t].bargraph2);done()}function getSizeAtVersion(t,o){var n="",e={},i=https.request({host:"raw.github.com",port:443,path:"/timrwood/moment/"+t+o},function(o){o.setEncoding("utf8"),o.on("data",function(t){n+=t}),o.on("end",function(){zlib.gzip(n,function(o,i){e.version=t,e.gzip=i.length,e.original=n.length,resolved++,check()})})});i.on("error",function(t){console.log("problem with request: "+t.message)}),i.end(),count++,outputs.push(e)}function getRemote(){var t,o="1.0.1 1.1.0 1.1.1 1.1.2 1.2.0 1.3.0 1.4.0".split(" "),n="1.5.0 1.5.1 1.6.0 1.6.1 1.7.0 1.7.1".split(" ");for(t=0;t<o.length;t++)getSizeAtVersion(o[t],"/moment.min.js");for(t=0;t<n.length;t++)getSizeAtVersion(n[t],"/min/moment.min.js")}function getLocal(){count++;var t={};outputs.push(t),fs.readFile(path.normalize(__dirname+"/../min/moment.min.js"),"utf8",function(o,n){if(o)throw o;zlib.gzip(n,function(o,e){t.version=".next",t.gzip=e.length,t.original=n.length,resolved++,check()})})}var done,https=require("https"),zlib=null,path=null,fs=null,count=0,resolved=0,outputs=[];module.exports=function(t){t.registerTask("history","Check the codebase filesize over different releases.",function(){done=this.async(),getRemote(),getLocal()})};