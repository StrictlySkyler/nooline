function safeStringify(e){var t;try{t=JSON.stringify(e)}catch(r){t=_safeStringify(e)}return t}function isReadStream(e){return e.readable&&e.path&&e.mode?!0:void 0}function toBase64(e){return new Buffer(e||"","ascii").toString("base64")}function md5(e){return crypto.createHash("md5").update(e).digest("hex")}function Request(e){var t,r;stream.Stream.call(this),this.readable=!0,this.writable=!0,"string"==typeof e&&(e={uri:e}),t=Object.keys(Request.prototype);for(r in e)-1===t.indexOf(r)?this[r]=e[r]:"function"==typeof e[r]&&delete e[r];e.method&&(this.explicitMethod=!0),this.init(e)}function toJSON(){return getSafe(this,"__"+(0|65536*(1+Math.random())).toString(16))}var hasHeader,getHeader,http=null,https=!1,tls=!1,url=null,util=null,stream=null,qs=null,querystring=null,crypto=null,oauth=null,hawk=null,aws=null,httpSignature=null,uuid=null,mime=null,tunnel=null,_safeStringify=null,ForeverAgent=null,FormData=null,Cookie=null,CookieJar=Cookie.Jar,cookieJar=new CookieJar,copy=null,debug=null,getSafe=null,globalPool={},isUrl=/^https?:/i;try{https=null}catch(e){}try{tls=null}catch(e){}https&&!https.Agent&&(https.Agent=function(e){http.Agent.call(this,e)},util.inherits(https.Agent,http.Agent),https.Agent.prototype._getConnection=function(e,t,r){var o=tls.connect(t,e,this.options,function(){r&&r()});return o}),util.inherits(Request,stream.Stream),Request.prototype.init=function(e){var t,r,o,s,i,a,n,u,h,d,p=this;if(e||(e={}),p.method||(p.method=e.method||"GET"),p.localAddress=e.localAddress,debug(e),p.pool||p.pool===!1||(p.pool=globalPool),p.dests=p.dests||[],p.__isRequestRequest=!0,!p._callback&&p.callback&&(p._callback=p.callback,p.callback=function(){p._callbackCalled||(p._callbackCalled=!0,p._callback.apply(p,arguments))},p.on("error",p.callback.bind()),p.on("complete",p.callback.bind(p,null))),p.url&&!p.uri&&(p.uri=p.url,delete p.url),!p.uri)return p.emit("error",Error("options.uri is a required argument"));if("string"==typeof p.uri&&(p.uri=url.parse(p.uri)),p.strictSSL===!1&&(p.rejectUnauthorized=!1),p.proxy&&("string"==typeof p.proxy&&(p.proxy=url.parse(p.proxy)),http.globalAgent&&"https:"===p.uri.protocol&&(t="http:"===p.proxy.protocol?tunnel.httpsOverHttp:tunnel.httpsOverHttps,r={proxy:{host:p.proxy.hostname,port:+p.proxy.port,proxyAuth:p.proxy.auth,headers:{Host:p.uri.hostname+":"+(p.uri.port||"https:"===p.uri.protocol?443:80)}},rejectUnauthorized:p.rejectUnauthorized,ca:this.ca},p.agent=t(r),p.tunnel=!0)),p.uri.pathname||(p.uri.pathname="/"),!p.uri.host)return o=url.format(p.uri),s='Invalid URI "'+o+'"',0===Object.keys(e).length&&(s+=". This can be caused by a crappy redirection."),p.emit("error",Error(s)),void 0;if(p._redirectsFollowed=p._redirectsFollowed||0,p.maxRedirects=void 0!==p.maxRedirects?p.maxRedirects:10,p.followRedirect=void 0!==p.followRedirect?p.followRedirect:!0,p.followAllRedirects=void 0!==p.followAllRedirects?p.followAllRedirects:!1,(p.followRedirect||p.followAllRedirects)&&(p.redirects=p.redirects||[]),p.headers=p.headers?copy(p.headers):{},p.setHost=!1,p.hasHeader("host")||(p.setHeader("host",p.uri.hostname),p.uri.port&&(80===p.uri.port&&"http:"===p.uri.protocol||443===p.uri.port&&"https:"===p.uri.protocol||p.setHeader("host",p.getHeader("host")+(":"+p.uri.port))),p.setHost=!0),p.jar(p._jar||e.jar),p.uri.port||("http:"==p.uri.protocol?p.uri.port=80:"https:"==p.uri.protocol&&(p.uri.port=443)),p.proxy&&!p.tunnel?(p.port=p.proxy.port,p.host=p.proxy.hostname):(p.port=p.uri.port,p.host=p.uri.hostname),p.clientErrorHandler=function(e){if(!p._aborted){if(p.req&&p.req._reusedSocket&&"ECONNRESET"===e.code&&p.agent.addRequestNoreuse)return p.agent={addRequest:p.agent.addRequestNoreuse.bind(p.agent)},p.start(),p.req.end(),void 0;p.timeout&&p.timeoutTimer&&(clearTimeout(p.timeoutTimer),p.timeoutTimer=null),p.emit("error",e)}},p._parserErrorHandler=function(e){this.res?this.res.request?this.res.request.emit("error",e):this.res.emit("error",e):this._httpMessage.emit("error",e)},e.form&&p.form(e.form),e.qs&&p.qs(e.qs),p.path=p.uri.path?p.uri.path:p.uri.pathname+(p.uri.search||""),0===p.path.length&&(p.path="/"),e.oauth&&p.oauth(e.oauth),e.aws&&p.aws(e.aws),e.hawk&&p.hawk(e.hawk),e.httpSignature&&p.httpSignature(e.httpSignature),e.auth&&p.auth(""===e.auth.user?e.auth.user:e.auth.user||e.auth.username,e.auth.pass||e.auth.password,e.auth.sendImmediately),p.uri.auth&&!p.hasHeader("authorization")&&(i=p.uri.auth.split(":").map(function(e){return querystring.unescape(e)}),p.auth(i[0],i.slice(1).join(":"),!0)),p.proxy&&p.proxy.auth&&!p.hasHeader("proxy-authorization")&&!p.tunnel&&p.setHeader("proxy-authorization","Basic "+toBase64(p.proxy.auth.split(":").map(function(e){return querystring.unescape(e)}).join(":"))),p.proxy&&!p.tunnel&&(p.path=p.uri.protocol+"//"+p.uri.host+p.path),e.json?p.json(e.json):e.multipart&&(p.boundary=uuid(),p.multipart(e.multipart)),p.body){if(a=0,Buffer.isBuffer(p.body))a=p.body.length;else if(Array.isArray(p.body))for(n=0;n<p.body.length;n++)a+=p.body[n].length;else p.body=new Buffer(p.body),a=p.body.length;if(!a)throw Error("Argument error, options.body.");p.hasHeader("content-length")||p.setHeader("content-length",a)}return u=p.proxy&&!p.tunnel?p.proxy.protocol:p.uri.protocol,h={"http:":http,"https:":https},d=p.httpModules||{},p.httpModule=d[u]||h[u],p.httpModule?(e.ca&&(p.ca=e.ca),p.agent||(e.agentOptions&&(p.agentOptions=e.agentOptions),p.agentClass=e.agentClass?e.agentClass:e.forever?"http:"===u?ForeverAgent:ForeverAgent.SSL:p.httpModule.Agent),p.pool===!1?p.agent=!1:(p.agent=p.agent||p.getAgent(),p.maxSockets&&(p.agent.maxSockets=p.maxSockets),p.pool.maxSockets&&(p.agent.maxSockets=p.pool.maxSockets)),p.on("pipe",function(e){if(p.ntick&&p._started)throw Error("You cannot pipe to this stream after the outbound request has started.");if(p.src=e,isReadStream(e))p.hasHeader("content-type")||p.setHeader("content-type",mime.lookup(e.path));else{if(e.headers)for(var t in e.headers)p.hasHeader(t)||p.setHeader(t,e.headers[t]);p._json&&!p.hasHeader("content-type")&&p.setHeader("content-type","application/json"),e.method&&!p.explicitMethod&&(p.method=e.method)}}),process.nextTick(function(){p._aborted||(p._form&&(p.setHeaders(p._form.getHeaders()),p._form.pipe(p)),p.body?(Array.isArray(p.body)?p.body.forEach(function(e){p.write(e)}):p.write(p.body),p.end()):p.requestBodyStream?(console.warn("options.requestBodyStream is deprecated, please pass the request object to stream.pipe."),p.requestBodyStream.pipe(p)):p.src||("GET"!==p.method&&void 0!==p.method&&p.setHeader("content-length",0),p.end()),p.ntick=!0)}),void 0):this.emit("error",Error("Invalid protocol"))},Request.prototype._updateProtocol=function(){var e,t,r=this,o=r.uri.protocol;if("https:"===o){if(r.proxy)return r.tunnel=!0,e="http:"===r.proxy.protocol?tunnel.httpsOverHttp:tunnel.httpsOverHttps,t={proxy:{host:r.proxy.hostname,port:+r.proxy.port,proxyAuth:r.proxy.auth},rejectUnauthorized:r.rejectUnauthorized,ca:r.ca},r.agent=e(t),void 0;switch(r.httpModule=https,r.agentClass){case ForeverAgent:r.agentClass=ForeverAgent.SSL;break;case http.Agent:r.agentClass=https.Agent;break;default:return}r.agent&&(r.agent=r.getAgent())}else{switch(r.tunnel&&(r.tunnel=!1),r.httpModule=http,r.agentClass){case ForeverAgent.SSL:r.agentClass=ForeverAgent;break;case https.Agent:r.agentClass=http.Agent;break;default:return}r.agent&&(r.agent=null,r.agent=r.getAgent())}},Request.prototype.getAgent=function(){var e,t,r,o,s=this.agentClass,i={};if(this.agentOptions)for(e in this.agentOptions)i[e]=this.agentOptions[e];return this.ca&&(i.ca=this.ca),void 0!==this.rejectUnauthorized&&(i.rejectUnauthorized=this.rejectUnauthorized),this.cert&&this.key&&(i.key=this.key,i.cert=this.cert),t="",s!==this.httpModule.Agent&&(t+=s.name),this.httpModule.globalAgent||(i.host=this.host,i.port=this.port,t&&(t+=":"),t+=this.host+":"+this.port),r=this.proxy,"string"==typeof r&&(r=url.parse(r)),o=r&&"https:"===r.protocol||"https:"===this.uri.protocol,o&&(i.ca&&(t&&(t+=":"),t+=i.ca),void 0!==i.rejectUnauthorized&&(t&&(t+=":"),t+=i.rejectUnauthorized),i.cert&&(t+=i.cert.toString("ascii")+i.key.toString("ascii")),i.ciphers&&(t&&(t+=":"),t+=i.ciphers),i.secureOptions&&(t&&(t+=":"),t+=i.secureOptions)),this.pool===globalPool&&!t&&0===Object.keys(i).length&&this.httpModule.globalAgent?this.httpModule.globalAgent:(t=this.uri.protocol+t,this.pool[t]?this.pool[t]:this.pool[t]=new s(i))},Request.prototype.start=function(){var e,t=this;t._aborted||(t._started=!0,t.method=t.method||"GET",t.href=t.uri.href,t.src&&t.src.stat&&t.src.stat.size&&!t.hasHeader("content-length")&&t.setHeader("content-length",t.src.stat.size),t._aws&&t.aws(t._aws,!0),e=copy(t),delete e.auth,debug("make request",t.uri.href),t.req=t.httpModule.request(e,t.onResponse.bind(t)),t.timeout&&!t.timeoutTimer&&(t.timeoutTimer=setTimeout(function(){t.req.abort();var e=Error("ETIMEDOUT");e.code="ETIMEDOUT",t.emit("error",e)},t.timeout),t.req.setTimeout&&t.req.setTimeout(t.timeout,function(){if(t.req){t.req.abort();var e=Error("ESOCKETTIMEDOUT");e.code="ESOCKETTIMEDOUT",t.emit("error",e)}})),t.req.on("error",t.clientErrorHandler),t.req.on("drain",function(){t.emit("drain")}),t.on("end",function(){t.req.connection&&t.req.connection.removeListener("error",t._parserErrorHandler)}),t.emit("request",t.req))},Request.prototype.onResponse=function(e){var t,r,o,s,i,a,n,u,h,d,p,c,l,f,g,m,y,b,_,H,q,w=this;if(debug("onResponse",w.uri.href,e.statusCode,e.headers),e.on("end",function(){debug("response end",w.uri.href,e.statusCode,e.headers)}),-1===e.connection.listeners("error").indexOf(w._parserErrorHandler)&&e.connection.once("error",w._parserErrorHandler),w._aborted)return debug("aborted",w.uri.href),e.resume(),void 0;if(w._paused?e.pause():e.resume(),w.response=e,e.request=w,e.toJSON=toJSON,w.httpModule===https&&w.strictSSL&&!e.client.authorized)return debug("strict ssl error",w.uri.href),t=e.client.authorizationError,w.emit("error",Error("SSL Error: "+t)),void 0;if(w.setHost&&w.hasHeader("host")&&delete w.headers[w.hasHeader("host")],w.timeout&&w.timeoutTimer&&(clearTimeout(w.timeoutTimer),w.timeoutTimer=null),r=function(e){w._jar&&(w._jar.add?w._jar.add(new Cookie(e)):cookieJar.add(new Cookie(e)))},hasHeader("set-cookie",e.headers)&&!w._disableCookies&&(o=hasHeader("set-cookie",e.headers),Array.isArray(e.headers[o])?e.headers[o].forEach(r):r(e.headers[o])),s=null,e.statusCode>=300&&e.statusCode<400&&hasHeader("location",e.headers)){if(i=e.headers[hasHeader("location",e.headers)],debug("redirect",i),w.followAllRedirects)s=i;else if(w.followRedirect)switch(w.method){case"PATCH":case"PUT":case"POST":case"DELETE":break;default:s=i}}else if(401==e.statusCode&&w._hasAuth&&!w._sentAuth)switch(a=e.headers[hasHeader("www-authenticate",e.headers)],n=a&&a.split(" ")[0],debug("reauth",n),n){case"Basic":w.auth(w._user,w._pass,!0),s=w.uri;break;case"Digest":for(u=a.match(/([a-z0-9_-]+)="([^"]+)"/gi),h={},d=0;d<u.length;d++)p=u[d].indexOf("="),c=u[d].substring(0,p),l=u[d].substring(p+1),h[c]=l.substring(1,l.length-1);f=md5(w._user+":"+h.realm+":"+w._pass),g=md5(w.method+":"+w.uri.path),m=md5(f+":"+h.nonce+":1::auth:"+g),y={username:w._user,realm:h.realm,nonce:h.nonce,uri:w.uri.path,qop:h.qop,response:m,nc:1,cnonce:""},a=[];for(b in y)a.push(b+'="'+y[b]+'"');a="Digest "+a.join(", "),w.setHeader("authorization",a),w._sentAuth=!0,s=w.uri}return s?(debug("redirect to",s),w._paused&&e.resume(),w._redirectsFollowed>=w.maxRedirects?(w.emit("error",Error("Exceeded maxRedirects. Probably stuck in a redirect loop "+w.uri.href)),void 0):(w._redirectsFollowed+=1,isUrl.test(s)||(s=url.resolve(w.uri.href,s)),_=w.uri,w.uri=url.parse(s),w.uri.protocol!==_.protocol&&w._updateProtocol(),w.redirects.push({statusCode:e.statusCode,redirectUri:s}),w.followAllRedirects&&401!=e.statusCode&&(w.method="GET"),delete w.src,delete w.req,delete w.agent,delete w._started,401!=e.statusCode&&(delete w.body,delete w._form,w.headers&&(w.hasHeader("host")&&delete w.headers[w.hasHeader("host")],w.hasHeader("content-type")&&delete w.headers[w.hasHeader("content-type")],w.hasHeader("content-length")&&delete w.headers[w.hasHeader("content-length")])),w.emit("redirect"),w.init(),void 0)):(w._redirectsFollowed=w._redirectsFollowed||0,e.on("close",function(){w._ended||w.response.emit("end")}),w.encoding&&(0!==w.dests.length?console.error("Ignoring encoding parameter as this stream is being piped to another stream which makes the encoding option invalid."):e.setEncoding(w.encoding)),w.emit("response",e),w.dests.forEach(function(e){w.pipeDest(e)}),e.on("data",function(e){w._destdata=!0,w.emit("data",e)}),e.on("end",function(e){w._ended=!0,w.emit("end",e)}),e.on("close",function(){w.emit("close")}),w.callback?(H=[],q=0,w.on("data",function(e){H.push(e),q+=e.length}),w.on("end",function(){var t,r;if(debug("end event",w.uri.href),w._aborted)return debug("aborted",w.uri.href),void 0;if(H.length&&Buffer.isBuffer(H[0])?(debug("has body",w.uri.href,q),t=new Buffer(q),r=0,H.forEach(function(e){e.copy(t,r,0,e.length),r+=e.length}),e.body=null===w.encoding?t:t.toString(w.encoding)):H.length&&("utf8"===w.encoding&&H[0].length>0&&"ï»¿"===H[0][0]&&(H[0]=H[0].substring(1)),e.body=H.join("")),w._json)try{e.body=JSON.parse(e.body)}catch(o){}debug("emitting complete",w.uri.href),void 0!=e.body||w._json||(e.body=""),w.emit("complete",e,e.body)})):w.on("end",function(){return w._aborted?(debug("aborted",w.uri.href),void 0):(w.emit("complete",e),void 0)}),debug("finish init function",w.uri.href),void 0)},Request.prototype.abort=function(){this._aborted=!0,this.req?this.req.abort():this.response&&this.response.abort(),this.emit("abort")},Request.prototype.pipeDest=function(e){var t,r,o,s=this.response;if(e.headers&&!e.headersSent&&(hasHeader("content-type",s.headers)&&(t=hasHeader("content-type",s.headers),e.setHeader?e.setHeader(t,s.headers[t]):e.headers[t]=s.headers[t]),hasHeader("content-length",s.headers)&&(r=hasHeader("content-length",s.headers),e.setHeader?e.setHeader(r,s.headers[r]):e.headers[r]=s.headers[r])),e.setHeader&&!e.headersSent){for(o in s.headers)e.setHeader(o,s.headers[o]);e.statusCode=s.statusCode}this.pipefilter&&this.pipefilter(s,e)},Request.prototype.setHeader=function(e,t,r){return void 0===r&&(r=!0),r||!this.hasHeader(e)?this.headers[e]=t:this.headers[this.hasHeader(e)]+=","+t,this},Request.prototype.setHeaders=function(e){for(var t in e)this.setHeader(t,e[t]);return this},Request.prototype.hasHeader=function(e,t){var r,o;for(t=Object.keys(t||this.headers),r=t.map(function(e){return e.toLowerCase()}),e=e.toLowerCase(),o=0;o<r.length;o++)if(r[o]===e)return t[o];return!1},hasHeader=Request.prototype.hasHeader,Request.prototype.qs=function(e,t){var r,o;r=!t&&this.uri.query?qs.parse(this.uri.query):{};for(o in e)r[o]=e[o];return""===qs.stringify(r)?this:(this.uri=url.parse(this.uri.href.split("?")[0]+"?"+qs.stringify(r)),this.url=this.uri,this.path=this.uri.path,this)},Request.prototype.form=function(e){return e?(this.setHeader("content-type","application/x-www-form-urlencoded; charset=utf-8"),this.body=qs.stringify(e).toString("utf8"),this):(this._form=new FormData,this._form)},Request.prototype.multipart=function(e){var t=this;if(t.body=[],t.hasHeader("content-type")?t.setHeader("content-type",t.headers["content-type"].split(";")[0]+"; boundary="+t.boundary):t.setHeader("content-type","multipart/related; boundary="+t.boundary),!e.forEach)throw Error("Argument error, options.multipart.");return t.preambleCRLF&&t.body.push(new Buffer("\r\n")),e.forEach(function(e){var r,o=e.body;if(null==o)throw Error("Body attribute missing in multipart.");delete e.body,r="--"+t.boundary+"\r\n",Object.keys(e).forEach(function(t){r+=t+": "+e[t]+"\r\n"}),r+="\r\n",t.body.push(new Buffer(r)),t.body.push(new Buffer(o)),t.body.push(new Buffer("\r\n"))}),t.body.push(new Buffer("--"+t.boundary+"--")),t},Request.prototype.json=function(e){var t=this;return t.hasHeader("accept")||t.setHeader("accept","application/json"),this._json=!0,"boolean"==typeof e?"object"==typeof this.body&&(this.body=safeStringify(this.body),t.setHeader("content-type","application/json")):(this.body=safeStringify(e),t.setHeader("content-type","application/json")),this},Request.prototype.getHeader=function(e,t){var r,o,s;return t||(t=this.headers),Object.keys(t).forEach(function(i){o=RegExp(e,"i"),s=i.match(o),s&&(r=t[i])}),r},getHeader=Request.prototype.getHeader,Request.prototype.auth=function(e,t,r){if("string"!=typeof e||void 0!==t&&"string"!=typeof t)throw Error("auth() received invalid user or password");this._user=e,this._pass=t,this._hasAuth=!0;var o=void 0!==t?e+":"+t:e;return(r||void 0===r)&&(this.setHeader("authorization","Basic "+toBase64(o)),this._sentAuth=!0),this},Request.prototype.aws=function(e,t){var r,o;return t?(r=new Date,this.setHeader("date",r.toUTCString()),o={key:e.key,secret:e.secret,verb:this.method.toUpperCase(),date:r,contentType:this.getHeader("content-type")||"",md5:this.getHeader("content-md5")||"",amazonHeaders:aws.canonicalizeHeaders(this.headers)},e.bucket&&this.path?o.resource="/"+e.bucket+this.path:e.bucket&&!this.path?o.resource="/"+e.bucket:!e.bucket&&this.path?o.resource=this.path:e.bucket||this.path||(o.resource="/"),o.resource=aws.canonicalizeResource(o.resource),this.setHeader("authorization",aws.authorization(o)),this):(this._aws=e,this)},Request.prototype.httpSignature=function(e){var t=this;return httpSignature.signRequest({getHeader:function(e){return getHeader(e,t.headers)},setHeader:function(e,r){t.setHeader(e,r)},method:this.method,path:this.path},e),debug("httpSignature authorization",this.getHeader("authorization")),this},Request.prototype.hawk=function(e){this.setHeader("Authorization",hawk.client.header(this.uri,this.method,e).field)},Request.prototype.oauth=function(e){var t,r,o,s,i,a,n,u,h;this.hasHeader("content-type")&&"application/x-www-form-urlencoded"===this.getHeader("content-type").slice(0,"application/x-www-form-urlencoded".length)&&(t=qs.parse(this.body)),this.uri.query&&(t=qs.parse(this.uri.query)),t||(t={}),r={};for(o in t)r[o]=t[o];for(o in e)r["oauth_"+o]=e[o];r.oauth_version||(r.oauth_version="1.0"),r.oauth_timestamp||(r.oauth_timestamp=""+Math.floor(Date.now()/1e3)),r.oauth_nonce||(r.oauth_nonce=uuid().replace(/-/g,"")),r.oauth_signature_method="HMAC-SHA1",s=r.oauth_consumer_secret,delete r.oauth_consumer_secret,i=r.oauth_token_secret,delete r.oauth_token_secret,a=r.oauth_timestamp,n=this.uri.protocol+"//"+this.uri.host+this.uri.pathname,u=oauth.hmacsign(this.method,n,r,s,i);for(o in t)o.slice(0,"oauth_")in e||(delete r["oauth_"+o],"x_auth_mode"!==o&&delete r[o]);return r.oauth_timestamp=a,h="OAuth "+Object.keys(r).sort().map(function(e){return e+'="'+oauth.rfc3986(r[e])+'"'}).join(","),h+=',oauth_signature="'+oauth.rfc3986(u)+'"',this.setHeader("Authorization",h),this},Request.prototype.jar=function(e){var t,r;return 0===this._redirectsFollowed&&(this.originalCookieHeader=this.getHeader("cookie")),e?t=e&&e.get?e.get({url:this.uri.href}):cookieJar.get({url:this.uri.href}):(t=!1,this._disableCookies=!0),t&&t.length&&(r=t.map(function(e){return e.name+"="+e.value}).join("; "),this.originalCookieHeader?this.setHeader("cookie",this.originalCookieHeader+"; "+r):this.setHeader("cookie",r)),this._jar=e,this},Request.prototype.pipe=function(e,t){if(this.response){if(this._destdata)throw Error("You cannot pipe after data has been emitted from the response.");if(this._ended)throw Error("You cannot pipe after the response has been ended.");return stream.Stream.prototype.pipe.call(this,e,t),this.pipeDest(e),e}return this.dests.push(e),stream.Stream.prototype.pipe.call(this,e,t),e},Request.prototype.write=function(){return this._started||this.start(),this.req.write.apply(this.req,arguments)},Request.prototype.end=function(e){e&&this.write(e),this._started||this.start(),this.req.end()},Request.prototype.pause=function(){this.response?this.response.pause.apply(this.response,arguments):this._paused=!0},Request.prototype.resume=function(){this.response?this.response.resume.apply(this.response,arguments):this._paused=!1},Request.prototype.destroy=function(){this._ended?this.response&&this.response.destroy():this.end()},Request.prototype.toJSON=toJSON,module.exports=Request;