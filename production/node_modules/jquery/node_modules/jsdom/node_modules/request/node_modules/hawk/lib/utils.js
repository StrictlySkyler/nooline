var Hoek=null,Sntp=null,Boom=null,internals={};internals.import=function(){for(var e in Hoek)Hoek.hasOwnProperty(e)&&(exports[e]=Hoek[e])},internals.import(),exports.version=function(){return exports.loadPackage(__dirname+"/..").version},exports.parseHost=function(e,t){var o,r,n;return t=t?t.toLowerCase():"host",(o=e.headers[t])?(r="["===o[0]?/^(?:(?:\r\n)?\s)*(\[[^\]]+\])(?::(\d+))?(?:(?:\r\n)?\s)*$/:/^(?:(?:\r\n)?\s)*([^:]+)(?::(\d+))?(?:(?:\r\n)?\s)*$/,n=o.match(r),n&&3===n.length&&n[1]?{name:n[1],port:n[2]?n[2]:e.connection&&e.connection.encrypted?443:80}:null):null},exports.parseContentType=function(e){return e?e.split(";")[0].trim().toLowerCase():""},exports.parseRequest=function(e,t){var o,r;return e.headers?t.host&&t.port||(o=exports.parseHost(e,t.hostHeaderName))?r={method:e.method,url:e.url,host:t.host||o.name,port:t.port||o.port,authorization:e.headers.authorization,contentType:e.headers["content-type"]||""}:Error("Invalid Host header"):e},exports.now=function(){return Sntp.now()},exports.parseAuthorizationHeader=function(e,t){var o,r,n,a,s,u;return t=t||["id","ts","nonce","hash","ext","mac","app","dlg"],e?(o=e.match(/^(\w+)(?:\s+(.*))?$/))?(r=o[1],"hawk"!==r.toLowerCase()?Boom.unauthorized(null,"Hawk"):(n=o[2])?(a={},s="",u=n.replace(/(\w+)="([^"\\]*)"\s*(?:,\s*|$)/g,function(e,o,r){return-1===t.indexOf(o)?(s="Unknown attribute: "+o,void 0):null===r.match(/^[ \w\!#\$%&'\(\)\*\+,\-\.\/\:;<\=>\?@\[\]\^`\{\|\}~]+$/)?(s="Bad attribute value: "+o,void 0):a.hasOwnProperty(o)?(s="Duplicate attribute: "+o,void 0):(a[o]=r,"")}),""!==u?Boom.badRequest(s||"Bad header format"):a):Boom.badRequest("Invalid header syntax")):Boom.badRequest("Invalid header syntax"):Boom.unauthorized(null,"Hawk")},exports.unauthorized=function(e){return Boom.unauthorized(e,"Hawk")};