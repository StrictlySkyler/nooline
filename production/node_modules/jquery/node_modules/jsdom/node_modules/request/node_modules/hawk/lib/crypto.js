var Crypto=null,Url=null,Utils=null,internals={};exports.headerVersion="1",exports.algorithms=["sha1","sha256"],exports.calculateMac=function(e,a,t){var r=exports.generateNormalizedString(e,t),n=Crypto.createHmac(a.algorithm,a.key).update(r),o=n.digest("base64");return o},exports.generateNormalizedString=function(e,a){var t="hawk."+exports.headerVersion+"."+e+"\n"+a.ts+"\n"+a.nonce+"\n"+(a.method||"").toUpperCase()+"\n"+(a.resource||"")+"\n"+a.host.toLowerCase()+"\n"+a.port+"\n"+(a.hash||"")+"\n";return a.ext&&(t+=a.ext.replace("\\","\\\\").replace("\n","\\n")),t+="\n",a.app&&(t+=a.app+"\n"+(a.dlg||"")+"\n"),t},exports.calculatePayloadHash=function(e,a,t){var r=exports.initializePayloadHash(a,t);return r.update(e||""),exports.finalizePayloadHash(r)},exports.initializePayloadHash=function(e,a){var t=Crypto.createHash(e);return t.update("hawk."+exports.headerVersion+".payload\n"),t.update(Utils.parseContentType(a)+"\n"),t},exports.finalizePayloadHash=function(e){return e.update("\n"),e.digest("base64")},exports.calculateTsMac=function(e,a){var t=Crypto.createHmac(a.algorithm,a.key);return t.update("hawk."+exports.headerVersion+".ts\n"+e+"\n"),t.digest("base64")};