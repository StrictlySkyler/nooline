var Crypto=null,Boom=null,internals={};exports.randomString=function(r){var t,n=exports.randomBits(6*(r+1));return n instanceof Error?n:(t=n.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,""),t.slice(0,r))},exports.randomBits=function(r){if(!r||0>r)return Boom.internal("Invalid random bits count");var t=Math.ceil(r/8);try{return Crypto.randomBytes(t)}catch(n){return Boom.internal("Failed generating random bits: "+n.message)}},exports.fixedTimeComparison=function(r,t){var n,e,o,a,i;if("string"!=typeof r||"string"!=typeof t)return!1;for(n=r.length===t.length?0:1,n&&(t=r),e=0,o=r.length;o>e;++e)a=r.charCodeAt(e),i=t.charCodeAt(e),n+=a===i?0:1;return 0===n};