var GOT,common=null,assert=common.assert,CombinedStream=common.CombinedStream,fs=null,FILE1=common.dir.fixture+"/file1.txt",BUFFER=new Buffer("Bacon is delicious"),FILE2=common.dir.fixture+"/file2.txt",STRING="The â‚¬ kicks the $'s ass!",EXPECTED=fs.readFileSync(FILE1)+BUFFER+fs.readFileSync(FILE2)+STRING;!function(){var e,t,n=CombinedStream.create();n.append(fs.createReadStream(FILE1)),n.append(BUFFER),n.append(fs.createReadStream(FILE2)),n.append(function(e){e(STRING)}),e=common.dir.tmp+"/combined-file1-buffer-file2-string.txt",t=fs.createWriteStream(e),n.pipe(t),t.on("close",function(){GOT=fs.readFileSync(e,"utf8")})}(),process.on("exit",function(){assert.strictEqual(GOT,EXPECTED)});