var GOT,common=null,assert=common.assert,CombinedStream=common.CombinedStream,fs=null,FILE1=common.dir.fixture+"/file1.txt",FILE2=common.dir.fixture+"/file2.txt",EXPECTED=fs.readFileSync(FILE1)+fs.readFileSync(FILE2);!function(){var e,t,n,r,a=CombinedStream.create();a.append(fs.createReadStream(FILE1)),a.append(fs.createReadStream(FILE2)),e=a._streams[0],t=a._streams[1],e.on("end",function(){assert.equal(t.dataSize,0)}),n=common.dir.tmp+"/combined.txt",r=fs.createWriteStream(n),a.pipe(r),r.on("close",function(){GOT=fs.readFileSync(n,"utf8")})}(),process.on("exit",function(){console.error(GOT.length,EXPECTED.length),assert.strictEqual(GOT,EXPECTED)});