function CombinedStream(){this.writable=!1,this.readable=!0,this.dataSize=0,this.maxDataSize=2097152,this.pauseStreams=!0,this._released=!1,this._streams=[],this._currentStream=null}var util=null,Stream=null.Stream,DelayedStream=null;module.exports=CombinedStream,util.inherits(CombinedStream,Stream),CombinedStream.create=function(t){var e,i=new this;t=t||{};for(e in t)i[e]=t[e];return i},CombinedStream.isStreamLike=function(t){return"function"!=typeof t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t&&!Buffer.isBuffer(t)},CombinedStream.prototype.append=function(t){var e=CombinedStream.isStreamLike(t);return e&&(t instanceof DelayedStream||(t.on("data",this._checkDataSize.bind(this)),t=DelayedStream.create(t,{maxDataSize:1/0,pauseStream:this.pauseStreams})),this._handleErrors(t),this.pauseStreams&&t.pause()),this._streams.push(t),this},CombinedStream.prototype.pipe=function(t,e){Stream.prototype.pipe.call(this,t,e),this.resume()},CombinedStream.prototype._getNext=function(){var t,e;return this._currentStream=null,t=this._streams.shift(),void 0===t?(this.end(),void 0):"function"!=typeof t?(this._pipeNext(t),void 0):(e=t,e(function(t){var e=CombinedStream.isStreamLike(t);e&&(t.on("data",this._checkDataSize.bind(this)),this._handleErrors(t)),this._pipeNext(t)}.bind(this)),void 0)},CombinedStream.prototype._pipeNext=function(t){var e,i;return this._currentStream=t,(e=CombinedStream.isStreamLike(t))?(t.on("end",this._getNext.bind(this)),t.pipe(this,{end:!1}),void 0):(i=t,this.write(i),this._getNext(),void 0)},CombinedStream.prototype._handleErrors=function(t){var e=this;t.on("error",function(t){e._emitError(t)})},CombinedStream.prototype.write=function(t){this.emit("data",t)},CombinedStream.prototype.pause=function(){this.pauseStreams&&this.emit("pause")},CombinedStream.prototype.resume=function(){this._released||(this._released=!0,this.writable=!0,this._getNext()),this.emit("resume")},CombinedStream.prototype.end=function(){this._reset(),this.emit("end")},CombinedStream.prototype.destroy=function(){this._reset(),this.emit("close")},CombinedStream.prototype._reset=function(){this.writable=!1,this._streams=[],this._currentStream=null},CombinedStream.prototype._checkDataSize=function(){if(this._updateDataSize(),!(this.dataSize<=this.maxDataSize)){var t="DelayedStream#maxDataSize of "+this.maxDataSize+" bytes exceeded.";this._emitError(Error(t))}},CombinedStream.prototype._updateDataSize=function(){this.dataSize=0;var t=this;this._streams.forEach(function(e){e.dataSize&&(t.dataSize+=e.dataSize)}),this._currentStream&&this._currentStream.dataSize&&(this.dataSize+=this._currentStream.dataSize)},CombinedStream.prototype._emitError=function(t){this._reset(),this.emit("error",t)};