// Copyright 2011 Joyent, Inc.  All rights reserved.

var assert=null,crypto=null;module.exports={verifySignature:function(r,e){var t,a,i;if(assert.object(r,"parsedSignature"),assert.string(e,"key"),t=r.algorithm.match(/(HMAC|RSA|DSA)-(\w+)/),!t||3!==t.length)throw new TypeError("parsedSignature: unsupported algorithm "+r.algorithm);return"HMAC"===t[1]?(a=crypto.createHmac(t[2].toUpperCase(),e),a.update(r.signingString),a.digest("base64")===r.params.signature):(i=crypto.createVerify(t[0]),i.update(r.signingString),i.verify(e,r.params.signature,"base64"))}};