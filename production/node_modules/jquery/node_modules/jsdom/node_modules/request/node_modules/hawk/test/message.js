var Url=null,Lab=null,Hoek=null,Hawk=null,internals={},expect=Lab.expect,before=Lab.before,after=Lab.after,describe=Lab.experiment,it=Lab.test;describe("Hawk",function(){var e=function(e,t){var a={id:e,key:"werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn",algorithm:"1"===e?"sha1":"sha256",user:"steve"};return t(null,a)};it("should generate an authorization then successfully parse it",function(t){e("123456",function(a,s){var o=Hawk.client.message("example.com",8080,"some message",{credentials:s});expect(o).to.exist,Hawk.server.authenticateMessage("example.com",8080,"some message",o,e,{},function(e,a){expect(e).to.not.exist,expect(a.user).to.equal("steve"),t()})})}),it("should fail authorization on mismatching host",function(t){e("123456",function(a,s){var o=Hawk.client.message("example.com",8080,"some message",{credentials:s});expect(o).to.exist,Hawk.server.authenticateMessage("example1.com",8080,"some message",o,e,{},function(e){expect(e).to.exist,expect(e.message).to.equal("Bad mac"),t()})})}),it("should fail authorization on stale timestamp",function(t){e("123456",function(a,s){var o=Hawk.client.message("example.com",8080,"some message",{credentials:s});expect(o).to.exist,Hawk.server.authenticateMessage("example.com",8080,"some message",o,e,{localtimeOffsetMsec:1e5},function(e){expect(e).to.exist,expect(e.message).to.equal("Stale timestamp"),t()})})}),it("should fail authorization on invalid authorization",function(t){e("123456",function(a,s){var o=Hawk.client.message("example.com",8080,"some message",{credentials:s});expect(o).to.exist,delete o.id,Hawk.server.authenticateMessage("example.com",8080,"some message",o,e,{},function(e){expect(e).to.exist,expect(e.message).to.equal("Invalid authorization"),t()})})}),it("should fail authorization on bad hash",function(t){e("123456",function(a,s){var o=Hawk.client.message("example.com",8080,"some message",{credentials:s});expect(o).to.exist,Hawk.server.authenticateMessage("example.com",8080,"some message1",o,e,{},function(e){expect(e).to.exist,expect(e.message).to.equal("Bad message hash"),t()})})}),it("should fail authorization on nonce error",function(t){e("123456",function(a,s){var o=Hawk.client.message("example.com",8080,"some message",{credentials:s});expect(o).to.exist,Hawk.server.authenticateMessage("example.com",8080,"some message",o,e,{nonceFunc:function(e,t,a){a(Error("kaboom"))}},function(e){expect(e).to.exist,expect(e.message).to.equal("Invalid nonce"),t()})})}),it("should fail authorization on credentials error",function(t){e("123456",function(e,a){var s,o=Hawk.client.message("example.com",8080,"some message",{credentials:a});expect(o).to.exist,s=function(e,t){t(Error("kablooey"))},Hawk.server.authenticateMessage("example.com",8080,"some message",o,s,{},function(e){expect(e).to.exist,expect(e.message).to.equal("kablooey"),t()})})}),it("should fail authorization on missing credentials",function(t){e("123456",function(e,a){var s,o=Hawk.client.message("example.com",8080,"some message",{credentials:a});expect(o).to.exist,s=function(e,t){t()},Hawk.server.authenticateMessage("example.com",8080,"some message",o,s,{},function(e){expect(e).to.exist,expect(e.message).to.equal("Unknown credentials"),t()})})}),it("should fail authorization on invalid credentials",function(t){e("123456",function(e,a){var s,o=Hawk.client.message("example.com",8080,"some message",{credentials:a});expect(o).to.exist,s=function(e,t){t(null,{})},Hawk.server.authenticateMessage("example.com",8080,"some message",o,s,{},function(e){expect(e).to.exist,expect(e.message).to.equal("Invalid credentials"),t()})})}),it("should fail authorization on invalid credentials algorithm",function(t){e("123456",function(e,a){var s,o=Hawk.client.message("example.com",8080,"some message",{credentials:a});expect(o).to.exist,s=function(e,t){t(null,{key:"123",algorithm:"456"})},Hawk.server.authenticateMessage("example.com",8080,"some message",o,s,{},function(e){expect(e).to.exist,expect(e.message).to.equal("Unknown algorithm"),t()})})}),it("should fail on missing host",function(t){e("123456",function(e,a){var s=Hawk.client.message(null,8080,"some message",{credentials:a});expect(s).to.not.exist,t()})}),it("should fail on missing credentials",function(e){var t=Hawk.client.message("example.com",8080,"some message",{});expect(t).to.not.exist,e()}),it("should fail on invalid algorithm",function(t){e("123456",function(e,a){var s,o=Hoek.clone(a);o.algorithm="blah",s=Hawk.client.message("example.com",8080,"some message",{credentials:o}),expect(s).to.not.exist,t()})})});