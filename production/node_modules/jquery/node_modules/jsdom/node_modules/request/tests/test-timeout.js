var server=null,events=null,stream=null,assert=null,request=null,s=server.createServer(),expectedBody="waited",remainingTests=5;s.listen(s.port,function(){function e(){0==--remainingTests&&(s.close(),console.log("All tests passed."))}var t,u,r,l,n;s.on("/timeout",function(e,t){setTimeout(function(){t.writeHead(200,{"content-type":"text/plain"}),t.write(expectedBody),t.end()},200)}),t={url:s.url+"/timeout",timeout:100},request(t,function(t){assert.equal(t.code,"ETIMEDOUT"),e()}),u={url:s.url+"/timeout",timeout:300},request(u,function(t,u,s){assert.equal(t,null),assert.equal(expectedBody,s),e()}),r={url:s.url+"/timeout"},request(r,function(t,u,s){assert.equal(t),assert.equal(expectedBody,s),e()}),l={url:s.url+"/timeout",timeout:-1e3},request(l,function(t){assert.equal(t.code,"ETIMEDOUT"),e()}),n={url:s.url+"/timeout",timeout:100.76},request(n,function(t){assert.equal(t.code,"ETIMEDOUT"),e()})});