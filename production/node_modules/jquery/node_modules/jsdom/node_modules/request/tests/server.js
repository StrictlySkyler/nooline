var fs=null,http=null,path=null,https=null,events=null,stream=null,assert=null;exports.createServer=function(e){e=e||6767;var t=http.createServer(function(e,n){t.emit(e.url,e,n)});return t.port=e,t.url="http://localhost:"+e,t},exports.createSSLServer=function(e,t){var n,r,a;if(e=e||16767,n={key:path.join(__dirname,"ssl","test.key"),cert:path.join(__dirname,"ssl","test.crt")},t)for(r in t)n[r]=t[r];for(r in n)n[r]=fs.readFileSync(n[r]);return a=https.createServer(n,function(e,t){a.emit(e.url,e,t)}),a.port=e,a.url="https://localhost:"+e,a},exports.createPostStream=function(e){var t=new stream.Stream;return t.writeable=!0,t.readable=!0,setTimeout(function(){t.emit("data",new Buffer(e)),t.emit("end")},0),t},exports.createPostValidator=function(e,t){var n=function(n,r){var a="";n.on("data",function(e){a+=e}),n.on("end",function(){if(n.headers["content-type"]&&n.headers["content-type"].indexOf("boundary=")>=0){var o=n.headers["content-type"].split("boundary=")[1];e=e.replace(/__BOUNDARY__/g,o)}a!==e&&console.log(a,e),assert.equal(a,e),t&&(assert.ok(n.headers["content-type"]),assert.ok(~n.headers["content-type"].indexOf(t))),r.writeHead(200,{"content-type":"text/plain"}),r.write("OK"),r.end()})};return n},exports.createGetResponse=function(e,t){var n=function(n,r){t=t||"text/plain",r.writeHead(200,{"content-type":t}),r.write(e),r.end()};return n},exports.createChunkResponse=function(e,t){var n=function(n,r){t=t||"text/plain",r.writeHead(200,{"content-type":t}),e.forEach(function(e){r.write(e)}),r.end()};return n};