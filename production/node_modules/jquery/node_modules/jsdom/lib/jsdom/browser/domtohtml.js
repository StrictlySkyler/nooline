function stringifyDoctype(e){if(e.ownerDocument&&e.ownerDocument._fullDT)return e.ownerDocument._fullDT;var t="<!DOCTYPE "+e.name;return e.publicId&&(t+=' PUBLIC "'+e.publicId+'" '),!e.publicId&&e.systemId&&(t+=" SYSTEM "),e.systemId&&(t+=e.systemId.indexOf('"')>-1?"'"+e.systemId+"'":'"'+e.systemId+'"'),t+=">"}var rawTextElements,singleTags={area:1,base:1,basefont:1,br:1,col:1,frame:1,hr:1,img:1,input:1,isindex:1,link:1,meta:1,param:1,embed:1},expr={upperCaseChars:/([A-Z])/g,breakBetweenTags:/(<(\/?\w+).*?>)(?=<(?!\/\2))/gi,singleTag:function(){var e,t=[];for(e in singleTags)t.push(e);return RegExp("<"+t.join("|<"),"i")}()},uncanon=function(e,t){return"-"+t.toLowerCase()},HTMLEncode=null.HTMLEncode;exports.stringifyElement=function(e){var t,n=e.tagName.toLowerCase(),r={start:"<"+n,end:""},o=[],s=null;if(e.attributes.length)for(r.start+=" ",t=0;t<e.attributes.length;t++)s=e.attributes.item(t),o.push(s.name+'="'+HTMLEncode(s.nodeValue,!0)+'"');return r.start+=o.join(" "),singleTags[n]?(r.start+=" />",r.end=""):(r.start+=">",r.end="</"+n+">"),r},rawTextElements=/SCRIPT|STYLE/i,exports.makeHtmlGenerator=function(e,t){return e=e||"",t=t||"",function n(r,o,s){var a,i,d,l="";if(s=s||"",r)switch(r.nodeType&&r.nodeType===r.ENTITY_REFERENCE_NODE&&(r=r._entity),d=o||rawTextElements.test(r.nodeName),r.nodeType){case r.ELEMENT_NODE:if(a=exports.stringifyElement(r),l+=d?s+a.start:s+a.start,r._childNodes.length>0){for(r._childNodes[0].nodeType!==r.TEXT_NODE&&(l+=t),i=0;i<r._childNodes.length;i++)l+=n(r._childNodes[i],d,s+e);r._childNodes[r._childNodes.length-1].nodeType!==r.TEXT_NODE&&(l+=s),l+=a.end+t}else l+=((o?r.nodeValue:HTMLEncode(r.nodeValue,!1))||"")+a.end+t;break;case r.TEXT_NODE:e&&/^[\s\n]*$/.test(r.nodeValue)||(l+=(o?r.nodeValue:HTMLEncode(r.nodeValue,!1))||"");break;case r.COMMENT_NODE:l+=s+"<!--"+r.nodeValue+"-->"+t;break;case r.DOCUMENT_NODE:for(i=0;i<r._childNodes.length;i++)l+=n(r._childNodes[i],d,s);break;case r.DOCUMENT_TYPE_NODE:l+=stringifyDoctype(r)}return l}},exports.domToHtml=function(e,t,n){var r,o,s,a=exports.makeHtmlGenerator(t?"":"  ",t?"":"\n");if(e.toArray&&(e=e.toArray()),void 0!==e.length){for(r="",o=0,s=e.length;s>o;o++)r+=a(e[o],n);return r}return a(e,n)};