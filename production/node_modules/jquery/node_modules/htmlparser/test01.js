function parse(t){switch(t.mode){case Mode.Text:return parseText(t);case Mode.Tags:return parseTags(t);case Mode.Attr:return parseAttr(t);case Mode.CData:return parseCData(t);case Mode.Comment:return parseComment(t)}}function parseText(t){var e,a;console.log("parseText",t),e=t.data.indexOf("<",t.pos),-1===e?(null!==t.pending?(t.output.push(t.pending+t.data.substring(t.pos,t.data.length)),t.pending=null):t.output.push(t.data.substring(t.pos,t.data.length)),t.pos=t.data.length):(a="",null!==t.pending?(a=t.pending+t.data.substring(t.pos,e-1),t.pending=null):a=t.data.substring(t.pos,e-1),t.output.push({type:Mode.Text,data:a}),t.pos=e+1,t.mode=Mode.Tags)}function parseTags(t){console.log("parseTags",t),re_parseTags.lastIndex=t.pos;var e=re_parseTags.exec(t.data);e&&">"===e[0]&&console.log("Just tag name",t.data.substring(t.pos,e.index)),process.exit()}function parseAttr(t){console.log("parseAttr",t)}function parseCData(t){console.log("parseCData",t)}function parseComment(t){console.log("parseComment",t)}var Mode,state,re_parseTags,data="starting text\n<htmL>\n	<body>\n		<div style=\"width:100%\"></div>\n		<div name='\"foo\"'>xxx</div>\n		<div bar=baz>xxx</div>\n		<div wrong='<foo>'>xxx</div>\n	</BODY>\n</html>\nending text";for(console.log(data),Mode={Text:"text",Tags:"tag",Attr:"attr",CData:"cdata",Comment:"comment"},state={mode:Mode.Text,pos:0,data:data,pending:null,output:[]},re_parseTags=/[\s>]/g;state.pos<state.data.length;)parse(state);