var fspfs=null,fs=null,http=null,https=null,net=null,should=null,assert=null;module.exports={"Library version":function(){fspfs.version.should.match(/^\d+\.\d+\.\d+$/)},"Create Server instance":function(){var e=fspfs.createServer(),o=new fspfs.Server({log:!1},["blog.3rd-Eden.com:1337"]);o.log.should.be.false,o.origins.length.should.equal(1),o.origins[0].should.equal("blog.3rd-Eden.com:1337"),(typeof e.log).should.be.equal("function"),e.origins.length.should.equal(1),e.origins[0].should.equal("*:*"),assert.ok(e instanceof fspfs.Server),assert.ok(!!e.buffer),e=fspfs.createServer(["blog.3rd-Eden.com:80"]),e.origins.length.should.equal(1),e.origins[0].should.equal("blog.3rd-Eden.com:80"),e=fspfs.createServer({log:!1},["blog.3rd-Eden.com:80"]),e.log.should.be.false,e.origins.length.should.equal(1),e.origins[0].should.equal("blog.3rd-Eden.com:80")},"Add origin":function(){var e,o,n=fspfs.createServer();for(n.add("google.com:80","blog.3rd-Eden.com:1337"),n.origins.length.should.equal(3),n.origins.indexOf("google.com:80").should.be.above(0),n.add("google.com:80","google.com:80"),e=n.origins.length,o=0;e--;)"google.com:80"===n.origins[e]&&o++;o.should.equal(1)},"Remove origin":function(){var e=fspfs.createServer();e.add("google.com:80","blog.3rd-Eden.com:1337"),e.origins.length.should.equal(3),e.remove("google.com:80"),e.origins.length.should.equal(2),e.origins.indexOf("google.com:80").should.equal(-1)},Buffer:function(){var e=fspfs.createServer();Buffer.isBuffer(e.buffer).should.be.true,(""+e.buffer).indexOf('to-ports="*"').should.be.above(0),(""+e.buffer).indexOf('domain="*"').should.be.above(0),(""+e.buffer).indexOf('domain="google.com"').should.equal(-1),e.add("google.com:80"),(""+e.buffer).indexOf('to-ports="80"').should.be.above(0),(""+e.buffer).indexOf('domain="google.com"').should.be.above(0),e.remove("google.com:80"),(""+e.buffer).indexOf('to-ports="80"').should.equal(-1),(""+e.buffer).indexOf('domain="google.com"').should.equal(-1)},Responder:function(){var e=fspfs.createServer(),o=0,n={readyState:"open",end:function(n){o++,Buffer.isBuffer(n).should.be.true,(""+n).should.equal(""+e.buffer)}};e.responder(n),o.should.equal(1)},"Event proxy":function(){var e=fspfs.createServer(),o=0;Object.keys(process.EventEmitter.prototype).forEach(function(o){assert.ok(!!e[o]&&"function"==typeof e[o])}),e.on("pew",function(){o++}),e.emit("pew"),o.should.equal(1)},"inline response http":function(){var e=1335,o=http.createServer(function(e,o){o.writeHead(200),o.end(":3")}),n=fspfs.createServer();o.listen(e,function(){n.listen(e+1,o,function(){var r=net.createConnection(e);r.write("<policy-file-request/>\x00"),r.on("error",function(e){assert.ok(!e,e)}),r.on("data",function(e){var s=""+e;console.log(s),s.indexOf('to-ports="*"').should.be.above(0),s.indexOf('domain="*"').should.be.above(0),s.indexOf('domain="google.com"').should.equal(-1),r.destroy(),n.close(),o.close()})})})},"server response":function(){var e=1340,o=fspfs.createServer();o.listen(e,function(){var n=net.createConnection(e);n.write("<policy-file-request/>\x00"),n.on("error",function(e){assert.ok(!e,e)}),n.on("data",function(e){var r=""+e;r.indexOf('to-ports="*"').should.be.above(0),r.indexOf('domain="*"').should.be.above(0),r.indexOf('domain="google.com"').should.equal(-1),n.destroy(),o.close()})})},"inline response https":function(){var e=1345,o={key:""+fs.readFileSync(__dirname+"/ssl/ssl.private.key"),cert:""+fs.readFileSync(__dirname+"/ssl/ssl.crt")},n=https.createServer(o,function(e,o){o.writeHead(200),o.end(":3")}),r=fspfs.createServer();n.listen(e,function(){r.listen(e+1,n,function(){var o=net.createConnection(e);o.write("<policy-file-request/>\x00"),o.on("error",function(e){assert.ok(!e,e)}),o.on("data",function(e){var s=""+e;s.indexOf('to-ports="*"').should.be.above(0),s.indexOf('domain="*"').should.be.above(0),s.indexOf('domain="google.com"').should.equal(-1),o.destroy(),r.close(),n.close()})})})},connect_failed:function(){var e=fspfs.createServer();e.on("connect_failed",function(){assert.ok(!0)}),e.listen(function(){assert.ok(!1,"Run this test without root access"),e.close()})}};