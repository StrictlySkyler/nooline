/*!
 * socket.io-node
 * Copyright(c) 2011 LearnBoost <dev@learnboost.com>
 * MIT Licensed
 */

function HTTPPolling(t,o,e){HTTPTransport.call(this,t,o,e)}var HTTPTransport=null;exports=module.exports=HTTPPolling,HTTPPolling.prototype.__proto__=HTTPTransport.prototype,HTTPPolling.prototype.name="httppolling",HTTPPolling.prototype.setHandlers=function(){HTTPTransport.prototype.setHandlers.call(this),this.socket.removeListener("end",this.bound.end),this.socket.removeListener("close",this.bound.close)},HTTPPolling.prototype.setHeartbeatInterval=function(){return this},HTTPPolling.prototype.handleRequest=function(t){if(HTTPTransport.prototype.handleRequest.call(this,t),"GET"==t.method){var o=this;this.pollTimeout=setTimeout(function(){o.packet({type:"noop"}),o.log.debug(o.name+" closed due to exceeded duration")},1e3*this.manager.get("polling duration")),this.log.debug("setting poll timeout")}},HTTPPolling.prototype.clearPollTimeout=function(){return this.pollTimeout&&(clearTimeout(this.pollTimeout),this.pollTimeout=null,this.log.debug("clearing poll timeout")),this},HTTPPolling.prototype.clearTimeouts=function(){HTTPTransport.prototype.clearTimeouts.call(this),this.clearPollTimeout()},HTTPPolling.prototype.doWrite=function(){this.clearPollTimeout()},HTTPPolling.prototype.write=function(t){this.doWrite(t),this.response.end(),this.onClose()},HTTPPolling.prototype.end=function(t){return this.clearPollTimeout(),HTTPTransport.prototype.end.call(this,t)};