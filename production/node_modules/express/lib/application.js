var connect=null,Router=null,methods=null,middleware=null,debug=null,locals=null.locals,View=null,utils=connect.utils,http=null,app=exports=module.exports={};app.init=function(){this.cache={},this.settings={},this.engines={},this.defaultConfiguration()},app.defaultConfiguration=function(){this.enable("x-powered-by"),this.enable("etag"),this.set("env",process.env.NODE_ENV||"development"),this.set("subdomain offset",2),debug("booting in %s mode",this.get("env")),this.use(connect.query()),this.use(middleware.init(this)),this.on("mount",function(t){this.request.__proto__=t.request,this.response.__proto__=t.response,this.engines.__proto__=t.engines,this.settings.__proto__=t.settings}),this._router=new Router(this),this.routes=this._router.map,this.__defineGetter__("router",function(){return this._usedRouter=!0,this._router.caseSensitive=this.enabled("case sensitive routing"),this._router.strict=this.enabled("strict routing"),this._router.middleware}),this.locals=locals(this),this.locals.settings=this.settings,this.set("view",View),this.set("views",process.cwd()+"/views"),this.set("jsonp callback name","callback"),this.configure("development",function(){this.set("json spaces",2)}),this.configure("production",function(){this.enable("view cache")})},app.use=function(t,e){var s;return"string"!=typeof t&&(e=t,t="/"),e.handle&&e.set&&(s=e),s&&(s.route=t,e=function(t,e,i){var n=t.app;s.handle(t,e,function(s){t.__proto__=n.request,e.__proto__=n.response,i(s)})}),connect.proto.use.call(this,t,e),s&&(s.parent=this,s.emit("mount",this)),this},app.engine=function(t,e){if("function"!=typeof e)throw Error("callback function required");return"."!=t[0]&&(t="."+t),this.engines[t]=e,this},app.param=function(t){var e=this,s=[].slice.call(arguments,1);return Array.isArray(t)?t.forEach(function(t){s.forEach(function(s){e.param(t,s)})}):"function"==typeof t?this._router.param(t):(":"==t[0]&&(t=t.substr(1)),s.forEach(function(s){e._router.param(t,s)})),this},app.set=function(t,e){return 1==arguments.length?this.settings[t]:(this.settings[t]=e,this)},app.path=function(){return this.parent?this.parent.path()+this.route:""},app.enabled=function(t){return!!this.set(t)},app.disabled=function(t){return!this.set(t)},app.enable=function(t){return this.set(t,!0)},app.disable=function(t){return this.set(t,!1)},app.configure=function(t,e){var s="all",i=[].slice.call(arguments);return e=i.pop(),i.length&&(s=i),("all"==s||~s.indexOf(this.settings.env))&&e.call(this),this},methods.forEach(function(t){app[t]=function(e){return"get"==t&&1==arguments.length?this.set(e):(Array.isArray(e)&&console.trace("passing an array to app.VERB() is deprecated and will be removed in 4.0"),this._usedRouter||this.use(this.router),this._router[t].apply(this._router,arguments),this)}}),app.all=function(){var t=arguments;return methods.forEach(function(e){app[e].apply(this,t)},this),this},app.del=app.delete,app.render=function(t,e,s){var i,n,r={},o=this.cache,a=this.engines;if("function"==typeof e&&(s=e,e={}),utils.merge(r,this.locals),e._locals&&utils.merge(r,e._locals),utils.merge(r,e),r.cache=null==r.cache?this.enabled("view cache"):r.cache,r.cache&&(i=o[t]),!i){if(i=new(this.get("view"))(t,{defaultEngine:this.get("view engine"),root:this.get("views"),engines:a}),!i.path)return n=Error('Failed to lookup view "'+t+'"'),n.view=i,s(n);r.cache&&(o[t]=i)}try{i.render(r,s)}catch(n){s(n)}},app.listen=function(){var t=http.createServer(this);return t.listen.apply(t,arguments)};