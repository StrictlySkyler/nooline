var http=null,multiparty=null,request=null,assert=null,host="localhost",index=['<form action="/" method="post" enctype="multipart/form-data">','  <input type="text" name="foo" />','  <input type="submit" />',"</form>"].join("\n"),server=http.createServer(function(t,e){if("GET"===t.method)return e.writeHead(200,{"content-type":"text/html"}),e.end(index),void 0;var r=new multiparty.Form;r.parse(t,function(t,r,n){e.writeHead(200,{"content-type":"text/plain"}),e.write(JSON.stringify({err:t,fields:r,files:n})),e.end()})}).listen(0,host,function(){var t=this,e="http://"+host+":"+t.address().port,r=[{"Content-Disposition":'form-data; name="foo"',body:"bar"}];request({method:"POST",url:e,multipart:r},function(e,r,n){var o=JSON.parse(n);assert.equal("bar",o.fields.foo),t.close()})});