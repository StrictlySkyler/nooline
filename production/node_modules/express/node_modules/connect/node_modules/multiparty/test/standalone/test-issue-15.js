function createRequest(t){var e,r,n="http://localhost:"+server.address().port+"/upload",s=superagent.post(n);s.attach("files[]",fixture("pf1y5.png"),"SOG2.JPG"),s.attach("files[]",fixture("binaryfile.tar.gz"),"BenF364_LIB353.zip"),e=s.get("content-type"),r=e.split(" "),s.set("content-type",r.join(t)),s.end(function(t){assert.ifError(t)})}function fixture(t){return path.join(__dirname,"..","fixture","file",t)}var http=null,multiparty=null,assert=null,superagent=null,path=null,server=http.createServer(function(t,e){var r,n;assert.strictEqual(t.url,"/upload"),assert.strictEqual(t.method,"POST"),r=new multiparty.Form({autoFields:!0,autoFiles:!0}),r.on("error",function(t){console.log(t)}),r.on("close",function(){}),n=0,r.on("file",function(){n+=1}),r.parse(t,function(t,r,s){var a=0;for(i in s)a+=1;assert.strictEqual(n,2),assert.strictEqual(a,1),e.end()})});server.listen(function(){var t,e,r="http://localhost:"+server.address().port+"/upload",n=superagent.post(r);n.attach("files[]",fixture("pf1y5.png"),"SOG2.JPG"),n.attach("files[]",fixture("binaryfile.tar.gz"),"BenF364_LIB353.zip"),t=n.get("content-type"),e=t.split(" "),n.set("content-type",e.join("")),n.end(function(t,e){assert.ifError(t),e.on("end",function(){server.close()})}),createRequest(""),createRequest(" "),createRequest("    ")});