var client,assert=null,http=null,net=null,multiparty=null,server=http.createServer(function(n){var t,e=new multiparty.Form({maxFields:1});e.on("aborted",function(){throw Error("did not expect aborted")}),t=!0,e.on("error",function(n){assert.ok(t),t=!1,client.end(),assert.ok(/maxFields/.test(n.message)),server.close()}),e.on("end",function(){throw Error('Unexpected "end" event')}),e.parse(n)});server.listen(function(){client=net.connect(server.address().port),client.write('POST /upload HTTP/1.1\r\nContent-Length: 728\r\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundaryvfUZhxgsZDO7FXLF\r\n\r\n------WebKitFormBoundaryvfUZhxgsZDO7FXLF\r\nContent-Disposition: form-data; name="title"\r\n\r\nfoofoo\r\n------WebKitFormBoundaryvfUZhxgsZDO7FXLF\r\nContent-Disposition: form-data; name="upload"; filename="blah1.txt"\r\nContent-Type: text/plain\r\n\r\nhi1\r\n\r\n------WebKitFormBoundaryvfUZhxgsZDO7FXLF\r\n')});