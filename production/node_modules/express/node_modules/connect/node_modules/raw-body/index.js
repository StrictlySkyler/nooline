module.exports=function(e,r,t){function n(e){if(a.push(e),c+=e.length,null!==l&&c>l){var r=Error("request entity too large");r.status=413,r.received=c,r.limit=l,t(r),i()}}function o(){if(null!==u&&c!==u){var e=Error("request size did not match content length");e.status=400,e.received=c,e.expected=u,t(e)}else t(null,Buffer.concat(a));i()}function i(){c=a=null,e.removeListener("data",n),e.removeListener("end",o),e.removeListener("error",t),e.removeListener("error",i),e.removeListener("close",i)}var l,u,s,c,a;return"function"==typeof r&&(t=r,r={}),l="number"==typeof r.limit?r.limit:null,u=isNaN(r.expected)?null:parseInt(r.expected,10),null!==l&&null!==u&&u>l?(s=Error("request entity too large"),s.status=413,s.expected=u,s.limit=l,t(s),e.resume(),i(),void 0):(c=0,a=[],e.on("data",n),e.once("end",o),e.once("error",t),e.once("error",i),e.once("close",i),void 0)};