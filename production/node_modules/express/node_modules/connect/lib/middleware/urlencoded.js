/*!
 * Connect - urlencoded
 * Copyright(c) 2010 Sencha Inc.
 * Copyright(c) 2011 TJ Holowaychuk
 * MIT Licensed
 */

var utils=null,getBody=null,bytes=null,qs=null;exports=module.exports=function(t){t=t||{};var e=t.limit?"number"==typeof t.limit?t.limit:"string"==typeof t.limit?bytes(t.limit):null:bytes("1mb");return function(i,l,n){return i._body?n():(i.body=i.body||{},utils.hasBody(i)?"application/x-www-form-urlencoded"!=utils.mime(i)?n():(i._body=!0,getBody(i,{limit:e,expected:i.headers["content-length"]},function(e,l){if(e)return n(e);l=l.toString("utf8").trim();try{i.body=l.length?qs.parse(l,t):{}}catch(e){return e.body=l,n(e)}n()}),void 0):n())}};