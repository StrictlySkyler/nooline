/*!
 * Connect - session - Store
 * Copyright(c) 2010 Sencha Inc.
 * Copyright(c) 2011 TJ Holowaychuk
 * MIT Licensed
 */

var EventEmitter=null.EventEmitter,Session=null,Cookie=null,Store=module.exports=function(){};Store.prototype.__proto__=EventEmitter.prototype,Store.prototype.regenerate=function(e,o){var t=this;this.destroy(e.sessionID,function(i){t.generate(e),o(i)})},Store.prototype.load=function(e,o){var t=this;this.get(e,function(i,n){if(i)return o(i);if(!n)return o();var r={sessionID:e,sessionStore:t};n=t.createSession(r,n),o(null,n)})},Store.prototype.createSession=function(e,o){var t=o.cookie.expires,i=o.cookie.originalMaxAge;return o.cookie=new Cookie(o.cookie),"string"==typeof t&&(o.cookie.expires=new Date(t)),o.cookie.originalMaxAge=i,e.session=new Session(e,o),e.session};