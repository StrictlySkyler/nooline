/**
* @preserve Copyright 2012 Twitter, Inc.
* @license http://www.apache.org/licenses/LICENSE-2.0.txt
*/

var HoganTemplate=function(){function n(n){this.text=n}function t(n){return n=(null===n?"":n)+"",c.test(n)?n.replace(r,"&amp;").replace(e,"&lt;").replace(o,"&gt;").replace(i,"&#39;").replace(u,"&quot;"):n}n.prototype={r:function(){return""},v:t,render:function(n,t,r){return this.r(n,t,r)},rp:function(n,t,r,e){var o=r[n];return o?o.r(t,r,e):""},rs:function(n,t,r){var e,o="",i=n[n.length-1];if(!a(i))return o=r(n,t);for(e=0;e<i.length;e++)n.push(i[e]),o+=r(n,t),n.pop();return o},s:function(n,t,r,e,o,i,u){var c;return a(n)&&0===n.length?!1:(!e&&"function"==typeof n&&(n=this.ls(n,t,r,o,i,u)),c=""===n||!!n,!e&&c&&t&&t.push("object"==typeof n?n:t[t.length-1]),c)},d:function(n,t,r,e){var o,i=n.split("."),u=this.f(i[0],t,r,e),c=null;if("."===n&&a(t[t.length-2]))return t[t.length-1];for(o=1;o<i.length;o++)u&&"object"==typeof u&&i[o]in u?(c=u,u=u[i[o]]):u="";return e&&!u?!1:(!e&&"function"==typeof u&&(t.push(c),u=this.lv(u,t,r),t.pop()),u)},f:function(n,t,r,e){var o,i=!1,u=null,c=!1;for(o=t.length-1;o>=0;o--)if(u=t[o],u&&"object"==typeof u&&n in u){i=u[n],c=!0;break}return c?(!e&&"function"==typeof i&&(i=this.lv(i,t,r)),i):e?!1:""},ho:function(n,t,r,e,o){var i=n.call(t,e,function(n){return Hogan.compile(n,{delimiters:o}).render(t,r)}),u=Hogan.compile(""+i,{delimiters:o}).render(t,r);return this.b=u,!1},b:"",ls:function(n,t,r,e,o,i){var u=t[t.length-1],c=n.call(u);return n.length>0?this.ho(n,u,r,this.text.substring(e,o),i):"function"==typeof c?this.ho(c,u,r,this.text.substring(e,o),i):c},lv:function(n,t,r){var e=t[t.length-1];return Hogan.compile(""+n.call(e)).render(e,r)}};var r=/&/g,e=/</g,o=/>/g,i=/\'/g,u=/\"/g,c=/[&<>\"\']/,a=Array.isArray||function(n){return"[object Array]"===Object.prototype.toString.call(n)};return n}(),Hogan=function(){function n(n,e){function o(){v.length>0&&(b.push(new String(v)),v="")}function i(){var n,t=!0;for(n=x;n<b.length;n++)if(t=b[n].tag&&y[b[n].tag]<y._v||!b[n].tag&&null===b[n].match(d),!t)return!1;return t}function u(n,t){if(o(),n&&i())for(var r,e=x;e<b.length;e++)b[e].tag||((r=b[e+1])&&">"==r.tag&&(r.indent=""+b[e]),b.splice(e,1));else t||b.push({tag:"\n"});m=!1,x=b.length}function c(n,r){var e="="+A,o=n.indexOf(e,r),i=t(n.substring(n.indexOf("=",r)+1,o)).split(" ");return H=i[0],A=i[1],o+e.length-1}var a=n.length,l=0,f=1,g=2,p=l,h=null,s=null,v="",b=[],m=!1,_=0,x=0,H="{{",A="}}";for(e&&(e=e.split(" "),H=e[0],A=e[1]),_=0;a>_;_++)p==l?r(H,n,_)?(--_,o(),p=f):"\n"==n.charAt(_)?u(m):v+=n.charAt(_):p==f?(_+=H.length-1,s=y[n.charAt(_+1)],h=s?n.charAt(_+1):"_v","="==h?(_=c(n,_),p=l):(s&&_++,p=g),m=_):r(A,n,_)?(b.push({tag:h,n:t(v),otag:H,ctag:A,i:"/"==h?m-A.length:_+H.length}),v="",_+=A.length-1,p=l,"{"==h&&_++):v+=n.charAt(_);return u(m,!0),b}function t(n){return n.trim?n.trim():n.replace(/^\s*|\s*$/g,"")}function r(n,t,r){if(t.charAt(r)!=n.charAt(0))return!1;for(var e=1,o=n.length;o>e;e++)if(t.charAt(r+e)!=n.charAt(e))return!1;return!0}function e(n,t,r,u){for(var c=[],a=null,l=null;n.length>0;)if(l=n.shift(),"#"==l.tag||"^"==l.tag||o(l,u))r.push(l),l.nodes=e(n,l.tag,r,u),c.push(l);else{if("/"==l.tag){if(0===r.length)throw Error("Closing tag without opener: /"+l.n);if(a=r.pop(),l.n!=a.n&&!i(l.n,a.n,u))throw Error("Nesting error: "+a.n+" vs. "+l.n);return a.end=l.i,c}c.push(l)}if(r.length>0)throw Error("missing closing tag: "+r.pop().n);return c}function o(n,t){for(var r=0,e=t.length;e>r;r++)if(t[r].o==n.n)return n.tag="#",!0}function i(n,t,r){for(var e=0,o=r.length;o>e;e++)if(r[e].c==n&&r[e].o==t)return!0}function u(n,t,r){var e,o='i = i || "";var c = [cx];var b = i + "";var _ = this;'+l(n)+"return b;";return r.asString?"function(cx,p,i){"+o+";}":(e=new HoganTemplate(t),e.r=Function("cx","p","i",o),e)}function c(n){return n.replace(x,"\\\\").replace(b,'\\"').replace(m,"\\n").replace(_,"\\r")}function a(n){return~n.indexOf(".")?"d":"f"}function l(n){var t,r,e,o="";for(t=0,r=n.length;r>t;t++)e=n[t].tag,"#"==e?o+=f(n[t].nodes,n[t].n,a(n[t].n),n[t].i,n[t].end,n[t].otag+" "+n[t].ctag):"^"==e?o+=g(n[t].nodes,n[t].n,a(n[t].n)):"<"==e||">"==e?o+=p(n[t]):"{"==e||"&"==e?o+=h(n[t].n,a(n[t].n)):"\n"==e?o+=v('"\\n"'+(n.length-1==t?"":" + i")):"_v"==e?o+=s(n[t].n,a(n[t].n)):void 0===e&&(o+=v('"'+c(n[t])+'"'));return o}function f(n,t,r,e,o,i){return"if(_.s(_."+r+'("'+c(t)+'",c,p,1),'+"c,p,0,"+e+","+o+', "'+i+'")){'+"b += _.rs(c,p,"+'function(c,p){ var b = "";'+l(n)+"return b;});c.pop();}"+'else{b += _.b; _.b = ""};'}function g(n,t,r){return"if (!_.s(_."+r+'("'+c(t)+'",c,p,1),c,p,1,0,0,"")){'+l(n)+"};"}function p(n){return'b += _.rp("'+c(n.n)+'",c[c.length - 1],p,"'+(n.indent||"")+'");'}function h(n,t){return"b += (_."+t+'("'+c(n)+'",c,p,0));'}function s(n,t){return"b += (_.v(_."+t+'("'+c(n)+'",c,p,0)));'}function v(n){return"b += "+n+";"}var d=/\S/,b=/\"/g,m=/\n/g,_=/\r/g,x=/\\/g,y={"#":1,"^":2,"/":3,"!":4,">":5,"<":6,"=":7,_v:8,"{":9,"&":10};return{scan:n,parse:function(n,t){return t=t||{},e(n,"",[],t.sectionTags||[])},cache:{},compile:function(t,r){r=r||{};var e=this.cache[t];return e?e:(e=u(this.parse(n(t,r.delimiters),r),t,r),this.cache[t]=e)}}}();"undefined"!=typeof module&&module.exports?(module.exports=Hogan,module.exports.Template=HoganTemplate):"function"==typeof define&&define.amd?define([],function(){return Hogan}):"undefined"!=typeof exports&&(exports.Hogan=Hogan,exports.HoganTemplate=HoganTemplate);