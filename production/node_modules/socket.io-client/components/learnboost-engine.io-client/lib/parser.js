var util=null,packets=exports.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},packetslist=util.keys(packets),err={type:"error",data:"parser error"};exports.encodePacket=function(e){var r=packets[e.type];return void 0!==e.data&&(r+=e.data+""),""+r},exports.decodePacket=function(e){var r=e.charAt(0);return Number(r)==r&&packetslist[r]?e.length>1?{type:packetslist[r],data:e.substring(1)}:{type:packetslist[r]}:err},exports.encodePayload=function(e){var r,t,a,n;if(!e.length)return"0:";for(t="",a=0,n=e.length;n>a;a++)r=exports.encodePacket(e[a]),t+=r.length+":"+r;return t},exports.decodePayload=function(e){var r,t,a,n,s,o,p,c;if(""==e)return[err];for(n=[],s="",o=0,p=e.length;p>o;o++)if(c=e.charAt(o),":"!=c)s+=c;else{if(""==s||s!=(r=Number(s)))return[err];if(t=e.substr(o+1,r),s!=t.length)return[err];if(t.length){if(a=exports.decodePacket(t),err.type==a.type&&err.data==a.data)return[err];n.push(a)}o+=r,s=""}return""!=s?[err]:n};