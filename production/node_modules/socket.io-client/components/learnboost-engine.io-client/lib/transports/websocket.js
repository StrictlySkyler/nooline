function WS(t){Transport.call(this,t)}function ws(){return"undefined"!=typeof process?null:global.WebSocket||global.MozWebSocket}var global,Transport=null,parser=null,util=null,debug=null;module.exports=WS,global="undefined"!=typeof window?window:global,util.inherits(WS,Transport),WS.prototype.name="websocket",WS.prototype.doOpen=function(){if(this.check()){var t=this;this.socket=new(ws())(this.uri()),this.socket.onopen=function(){t.onOpen()},this.socket.onclose=function(){t.onClose()},this.socket.onmessage=function(o){t.onData(o.data)},this.socket.onerror=function(o){t.onError("websocket error",o)}}},WS.prototype.write=function(t){for(var o=0,e=t.length;e>o;o++)this.socket.send(parser.encodePacket(t[o]))},WS.prototype.doClose=function(){void 0!==this.socket&&this.socket.close()},WS.prototype.uri=function(){var t=this.query||{},o=this.secure?"wss":"ws",e="";return this.port&&("wss"==o&&443!=this.port||"ws"==o&&80!=this.port)&&(e=":"+this.port),this.timestampRequests&&(t[this.timestampParam]=+new Date),t=util.qs(t),t.length&&(t="?"+t),o+"://"+this.host+e+this.path+t},WS.prototype.check=function(){var t=ws();return!(!t||"__initialize"in t&&this.name===WS.prototype.name)};