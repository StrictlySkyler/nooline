/**
 * socket.io
 * Copyright(c) 2011 LearnBoost <dev@learnboost.com>
 * MIT Licensed
 */

!function(t,e,o){function s(t){t&&(e.Transport.apply(this,arguments),this.sendBuffer=[])}function n(){}t.XHR=s,e.util.inherit(s,e.Transport),s.prototype.open=function(){return this.socket.setBuffer(!1),this.onOpen(),this.get(),this.setCloseTimeout(),this},s.prototype.payload=function(t){var o,s,n=[];for(o=0,s=t.length;s>o;o++)n.push(e.parser.encodePacket(t[o]));this.send(e.parser.encodePayload(n))},s.prototype.send=function(t){return this.post(t),this},s.prototype.post=function(t){function e(){4==this.readyState&&(this.onreadystatechange=n,i.posting=!1,200==this.status?i.socket.setBuffer(!1):i.onClose())}function s(){this.onload=n,i.socket.setBuffer(!1)}var i=this;this.socket.setBuffer(!0),this.sendXHR=this.request("POST"),o.XDomainRequest&&this.sendXHR instanceof XDomainRequest?this.sendXHR.onload=this.sendXHR.onerror=s:this.sendXHR.onreadystatechange=e,this.sendXHR.send(t)},s.prototype.close=function(){return this.onClose(),this},s.prototype.request=function(t){var o=e.util.request(this.socket.isXDomain()),s=e.util.query(this.socket.options.query,"t="+ +new Date);if(o.open(t||"GET",this.prepareUrl()+s,!0),"POST"==t)try{o.setRequestHeader?o.setRequestHeader("Content-type","text/plain;charset=UTF-8"):o.contentType="text/plain"}catch(n){}return o},s.prototype.scheme=function(){return this.socket.options.secure?"https":"http"},s.check=function(t,s){try{var n=e.util.request(s),i=o.XDomainRequest&&n instanceof XDomainRequest,r=t&&t.options&&t.options.secure?"https:":"http:",u=o.location&&r!=o.location.protocol;if(n&&(!i||!u))return!0}catch(p){}return!1},s.xdomainCheck=function(t){return s.check(t,!0)}}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this);