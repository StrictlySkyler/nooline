function start(e){xhr=new XMLHttpRequest,xhr.onreadystatechange=function(){4==this.readyState&&("HEAD"==e?assert.equal("",this.responseText):assert.equal("Hello World",this.responseText),curMethod++,curMethod<methods.length&&(sys.puts("Testing "+methods[curMethod]),start(methods[curMethod])))};var t="http://localhost:8000/"+e;xhr.open(e,t),xhr.send()}var xhr,sys=require("util"),assert=require("assert"),XMLHttpRequest=require("../lib/XMLHttpRequest").XMLHttpRequest,http=require("http"),server=http.createServer(function(e,t){assert.equal(methods[curMethod],e.method),assert.equal("/"+methods[curMethod],e.url);var s="HEAD"!=e.method?"Hello World":"";t.writeHead(200,{"Content-Type":"text/plain","Content-Length":Buffer.byteLength(s)}),"HEAD"!=e.method&&t.write(s),t.end(),curMethod==methods.length-1&&(this.close(),sys.puts("done"))}).listen(8e3),methods=["GET","POST","HEAD","PUT","DELETE"],curMethod=0;sys.puts("Testing "+methods[curMethod]),start(methods[curMethod]);