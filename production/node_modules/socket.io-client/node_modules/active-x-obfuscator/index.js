function ActiveXObfuscator(e){if(!(this instanceof ActiveXObfuscator)){var t=new ActiveXObfuscator(e);return t.execute(),""+t}this._parser=ZeParser.createParser(e)}var OBFUSCATED_ACTIVE_X_OBJECT,OBFUSCATED_ACTIVE_X,ZeParser=null.ZeParser,Util=null;module.exports=ActiveXObfuscator,OBFUSCATED_ACTIVE_X_OBJECT=ActiveXObfuscator.OBFUSCATED_ACTIVE_X_OBJECT="(['Active'].concat('Object').join('X'))",OBFUSCATED_ACTIVE_X=ActiveXObfuscator.OBFUSCATED_ACTIVE_X="(['Active'].concat('').join('X'))",ActiveXObfuscator.prototype.execute=function(){this._parser.tokenizer.fixValues(),this._obfuscate(this.getAst())},ActiveXObfuscator.prototype.getAst=function(){return this._parser.stack},ActiveXObfuscator.prototype.getWhiteTokens=function(){return this._parser.tokenizer.wtree},ActiveXObfuscator.prototype._obfuscate=function(e){var t=this;e.forEach(function(r,c){var i,a;if(Array.isArray(r))return t._obfuscate(r),void 0;switch(r.value){case"ActiveXObject":if(!r.isPropertyName){r.value="window["+OBFUSCATED_ACTIVE_X_OBJECT+"]";break}i=e[c-1],a=t.getWhiteTokens(),a[i.tokposw].value="",r.value="["+OBFUSCATED_ACTIVE_X_OBJECT+"]";break;case"'ActiveXObject'":case'"ActiveXObject"':r.value=OBFUSCATED_ACTIVE_X_OBJECT;break;case"'ActiveX'":case'"ActiveX"':r.value=OBFUSCATED_ACTIVE_X;break;default:if(!/ActiveX/i.test(r.value))break;if(!r.isComment)throw Error("Unknown ActiveX occurence in: "+Util.inspect(r));r.value=r.value.replace(/ActiveX/i,"Ac...eX")}})},ActiveXObfuscator.prototype.toString=function(){var e=this.getWhiteTokens();return e.reduce(function(e,t){return e+=t.value},"")};