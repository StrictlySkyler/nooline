var activeXObfuscator=null,assert=null,OBFUSCATED_ACTIVE_X_OBJECT=activeXObfuscator.OBFUSCATED_ACTIVE_X_OBJECT,OBFUSCATED_ACTIVE_X=activeXObfuscator.OBFUSCATED_ACTIVE_X,input="foo(new ActiveXObject('Microsoft.XMLHTTP'))",expected="foo(new window["+OBFUSCATED_ACTIVE_X_OBJECT+"]('Microsoft.XMLHTTP'))";assert.equal(activeXObfuscator(input),expected),input="var foo = 'ActiveXObject';",expected="var foo = "+OBFUSCATED_ACTIVE_X_OBJECT+";",assert.equal(activeXObfuscator(input),expected),input='var foo = "ActiveXObject";',expected="var foo = "+OBFUSCATED_ACTIVE_X_OBJECT+";",assert.equal(activeXObfuscator(input),expected),input="var foo = o.ActiveXObject;",expected="var foo = o["+OBFUSCATED_ACTIVE_X_OBJECT+"];",assert.equal(activeXObfuscator(input),expected),input='var foo = "ActiveX";',expected="var foo = "+OBFUSCATED_ACTIVE_X+";",assert.equal(activeXObfuscator(input),expected),input="var foo = 'ActiveX';",expected="var foo = "+OBFUSCATED_ACTIVE_X+";",assert.equal(activeXObfuscator(input),expected),input="var foo; // ActiveX is cool",expected="var foo; // Ac...eX is cool",assert.equal(activeXObfuscator(input),expected),input="var foo = 'ActiveX is cool';",assert.throws(function(){activeXObfuscator(input)},/Unknown ActiveX occurence/);