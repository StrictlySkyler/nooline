function instrument(t){function r(){var t;return this[0].start&&i.indexOf(this)<0&&(i.push(this),t=["splice",[["stat",["call",["name","trace"],[["string",""+this[0]],["num",this[0].start.line],["num",this[0].start.col],["num",this[0].end.line],["num",this[0].end.col]]]],n.walk(this)]],i.pop(this)),t}var e=jsp.parse(t,!1,!0),n=pro.ast_walker(),i=[],s=n.with_walkers({stat:r,label:r,"break":r,"continue":r,"debugger":r,"var":r,"const":r,"return":r,"throw":r,"try":r,defun:r,"if":r,"while":r,"do":r,"for":r,"for-in":r,"switch":r,"with":r},function(){return n.walk(e)});return pro.gen_code(s,{beautify:!0})}function test(){return a=5,c+=a+b,1}var jsp=require("uglify-js").parser,pro=require("uglify-js").uglify,code=instrument(""+test);console.log(code);