/*!
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */

getBufferFromHexString=function(r){var e,n=r.split(" "),t=new Buffer(n.length);for(e=0;e<n.length;++e)t[e]=parseInt(n[e],16);return t},getHexStringFromBuffer=function(r){var e,n="";for(e=0;e<r.length;++e)n+=padl(r[e].toString(16),2,"0")+" ";return n.trim()},splitBuffer=function(r){var e,n=new Buffer(Math.ceil(r.length/2));return r.copy(n,0,0,n.length),e=new Buffer(Math.floor(r.length/2)),r.copy(e,0,n.length,n.length+e.length),[n,e]},mask=function(r,e){var n,t;for("string"==typeof r&&(r=new Buffer(r)),n=getBufferFromHexString(e||"34 83 a8 68"),t=0;t<r.length;++t)r[t]^=n[t%4];return r},getHybiLengthAsHexString=function(r,e){var n;return 126>r?(n=new Buffer(1),n[0]=(e?128:0)|r):65536>r?(n=new Buffer(3),n[0]=126|(e?128:0),getBufferFromHexString(pack(4,r)).copy(n,1)):(n=new Buffer(9),n[0]=127|(e?128:0),getBufferFromHexString(pack(16,r)).copy(n,1)),getHexStringFromBuffer(n)},unpack=function(r){var e,n=0;for(e=0;e<r.length;++e)n=0==e?r[e]:256*n+r[e];return n},pack=function(r,e){return padl(e.toString(16),r,"0").replace(/([0-9a-f][0-9a-f])/gi,"$1 ").trim()},padl=function(r,e,n){return Array(1+e-r.length).join(n)+r};