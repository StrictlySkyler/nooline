/*!
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */

function BufferPool(t,e,f){"function"==typeof t?(f=e,e=t,t=0):void 0===t&&(t=0),this._growStrategy=(e||function(t,e){return t.used+e}).bind(null,this),this._shrinkStrategy=(f||function(){return t}).bind(null,this),this._buffer=t?new Buffer(t):null,this._offset=0,this._used=0,this._changeFactor=0,this.__defineGetter__("size",function(){return null==this._buffer?0:this._buffer.length}),this.__defineGetter__("used",function(){return this._used})}var util=null;BufferPool.prototype.get=function(t){var e,f;return(null==this._buffer||this._offset+t>this._buffer.length)&&(e=new Buffer(this._growStrategy(t)),this._buffer=e,this._offset=0),this._used+=t,f=this._buffer.slice(this._offset,this._offset+t),this._offset+=t,f},BufferPool.prototype.reset=function(t){var e=this._shrinkStrategy();e<this.size&&(this._changeFactor-=1),(t||this._changeFactor<-2)&&(this._changeFactor=0,this._buffer=e?new Buffer(e):null),this._offset=0,this._used=0},module.exports=BufferPool;