var i,start,converter,b,duration,mbs,buf,s,iconv=null,iconv_lite=require("../index"),encoding=process.argv[2]||"windows-1251",convertTimes=1e4,encodingStrings={"windows-1251":"This is a test string 32 chars..",gbk:"这是中文字符测试。。！@￥%12",utf8:"这是中文字符测试。。！@￥%12This is a test string 48 chars.."},str=encodingStrings[encoding];if(!str)throw Error("Don't support "+encoding+" performance test.");for(i=0;13>i;i++)str+=str;for(console.log("\n"+encoding+" charset performance test:"),console.log("\nEncoding "+str.length+" chars "+convertTimes+" times:"),start=Date.now(),converter=new iconv.Iconv("utf8",encoding),i=0;convertTimes>i;i++)b=converter.convert(str);for(duration=Date.now()-start,mbs=convertTimes*b.length/duration/1024,console.log("iconv: "+duration+"ms, "+mbs.toFixed(2)+" Mb/s."),start=Date.now(),i=0;convertTimes>i;i++)b=iconv_lite.encode(str,encoding);for(duration=Date.now()-start,mbs=convertTimes*b.length/duration/1024,console.log("iconv-lite: "+duration+"ms, "+mbs.toFixed(2)+" Mb/s."),buf=iconv_lite.encode(str,encoding),console.log("\nDecoding "+buf.length+" bytes "+convertTimes+" times:"),start=Date.now(),converter=new iconv.Iconv(encoding,"utf8"),i=0;convertTimes>i;i++)s=""+converter.convert(buf);for(duration=Date.now()-start,mbs=convertTimes*buf.length/duration/1024,console.log("iconv: "+duration+"ms, "+mbs.toFixed(2)+" Mb/s."),start=Date.now(),i=0;convertTimes>i;i++)s=iconv_lite.decode(buf,encoding);duration=Date.now()-start,mbs=convertTimes*buf.length/duration/1024,console.log("iconv-lite: "+duration+"ms, "+mbs.toFixed(2)+" Mb/s.");