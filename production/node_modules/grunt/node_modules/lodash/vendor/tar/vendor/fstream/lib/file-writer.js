function FileWriter(e){var r=this;if(!(r instanceof FileWriter))throw Error("FileWriter must be called as constructor.");if("File"!==e.type||!e.File)throw Error("Non-file type "+e.type);r._buffer=[],r._bytesWritten=0,Writer.call(this,e)}module.exports=FileWriter;var fs=require("../../graceful-fs/graceful-fs.js"),mkdir=require("../../mkdirp"),Writer=require("./writer.js"),inherits=require("../../inherits/inherits.js"),EOF={};inherits(FileWriter,Writer),FileWriter.prototype._create=function(){var e,r=this;r._stream||(e={},r.props.flags&&(e.flags=r.props.flags),e.mode=Writer.filemode,r._old&&r._old.blksize&&(e.bufferSize=r._old.blksize),r._stream=fs.createWriteStream(r._path,e),r._stream.on("open",function(){r.ready=!0,r._buffer.forEach(function(e){e===EOF?r._stream.end():r._stream.write(e)}),r.emit("ready")}),r._stream.on("drain",function(){r.emit("drain")}),r._stream.on("close",function(){r._finish()}))},FileWriter.prototype.write=function(e){var r,t=this;return t._bytesWritten+=e.length,t.ready?(r=t._stream.write(e),r||t._stream._queue&&t._stream._queue.length<=2):(t._buffer.push(e),!1)},FileWriter.prototype.end=function(e){var r=this;return e&&r.write(e),r.ready?r._stream.end():(r._buffer.push(EOF),!1)},FileWriter.prototype._finish=function(){var e=this;"number"==typeof e.size&&e._bytesWritten!=e.size&&e.error("Did not get expected byte count.\nexpect: "+e.size+"\n"+"actual: "+e._bytesWritten),Writer.prototype._finish.call(e)};