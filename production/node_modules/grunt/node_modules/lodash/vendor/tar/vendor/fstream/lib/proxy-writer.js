function ProxyWriter(r){var t=this;if(!(t instanceof ProxyWriter))throw Error("ProxyWriter must be called as constructor.");t.props=r,t._needDrain=!1,Writer.call(t,r)}module.exports=ProxyWriter;var Writer=require("./writer.js"),getType=require("./get-type.js"),inherits=require("../../inherits/inherits.js"),collect=require("./collect.js"),fs=require("fs");inherits(ProxyWriter,Writer),ProxyWriter.prototype._stat=function(){var r=this,t=r.props,e=t.follow?"stat":"lstat";fs[e](t.path,function(e,i){var o;o=e||!i?"File":getType(i),t[o]=!0,t.type=r.type=o,r._old=i,r._addProxy(Writer(t,i))})},ProxyWriter.prototype._addProxy=function(r){var t,e=this;return e._proxy?e.error("proxy already set"):(e._proxy=r,["ready","error","close","pipe","drain","warn"].forEach(function(t){r.on(t,e.emit.bind(e,t))}),e.emit("proxy",r),t=e._buffer,t.forEach(function(t){r[t[0]].call(r,t[1])}),e._buffer.length=0,e._needsDrain&&e.emit("drain"),void 0)},ProxyWriter.prototype.add=function(r){return collect(r),this._proxy?this._proxy.add(r):(this._buffer.push(["add",[r]]),this._needDrain=!0,!1)},ProxyWriter.prototype.write=function(r){return this._proxy?this._proxy.write(r):(this._buffer.push(["write",[r]]),this._needDrain=!0,!1)},ProxyWriter.prototype.end=function(r){return this._proxy?this._proxy.end(r):(this._buffer.push(["end",r]),!1)};