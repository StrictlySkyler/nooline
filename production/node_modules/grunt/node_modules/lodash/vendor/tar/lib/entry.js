function Entry(e,i,t){Stream.call(this),this.readable=!0,this.writable=!0,this._needDrain=!1,this._paused=!1,this._reading=!1,this._ending=!1,this._ended=!1,this._remaining=0,this._queue=[],this._index=0,this._queueLen=0,this._read=this._read.bind(this),this.props={},this._header=e,this._extended=i||{},this._global={};var s=this;Object.keys(t||{}).forEach(function(e){s._global[e]=t[e]}),this._setProps()}module.exports=Entry;var TarHeader=require("./header.js"),tar=require("../tar"),assert=require("assert").ok,Stream=require("stream").Stream,inherits=require("../vendor/inherits/inherits.js"),fstream=require("../vendor/fstream/fstream.js").Abstract;inherits(Entry,Stream,{write:function(e){this._ending&&this.error("write() after end()",null,!0),0===this._remaining&&this.error("invalid bytes past eof"),e.length>this._remaining&&(e=e.slice(0,this._remaining)),this._remaining-=e.length;var i=this._queueLen;return this._queue.push(e),this._queueLen++,this._read(),this._paused||i>0?(this._needDrain=!0,!1):!0},end:function(e){e&&this.write(e),this._ending=!0,this._read()},pause:function(){this._paused=!0,this.emit("pause")},resume:function(){return this.emit("resume"),this._paused=!1,this._read(),this._queueLen-this._index>1},_read:function(){var e,i;this._paused||this._reading||this._ended||(this._reading=!0,this._index<this._queueLen&&(e=this._queue[this._index++],this.emit("data",e)),this._index>=this._queueLen&&(this._queue.length=this._queueLen=this._index=0,this._needDrain&&(this._needDrain=!1,this.emit("drain")),this._ending&&(this._ended=!0,this.emit("end"))),i=this._maxQueueLen,this._queueLen>i&&this._index>0&&(i=Math.min(this._index,i),this._index-=i,this._queueLen-=i,this._queue=this._queue.slice(i)),this._reading=!1)},_setProps:function(){var e,i,t,s,r=this._header,n=this._extended,h=this._global,a=this.props,u=tar.fields;for(e=0;null!==u[e];e++)i=u[e],t=r[i],void 0!==t&&(a[i]=t);switch([h,n].forEach(function(e){Object.keys(e).forEach(function(i){void 0!==e[i]&&(a[i]=e[i])})}),["path","linkpath"].forEach(function(e){a.hasOwnProperty(e)&&(a[e]=a[e].split("\x00")[0])}),["mtime","ctime","atime"].forEach(function(e){a.hasOwnProperty(e)&&(a[e]=new Date(1e3*a[e]))}),tar.types[a.type]){case"OldFile":case"ContiguousFile":s="File";break;case"GNUDumpDir":s="Directory";break;case void 0:s="Unknown";break;case"Link":case"SymbolicLink":case"CharacterDevice":case"BlockDevice":case"Directory":case"FIFO":default:s=tar.types[a.type]}this.type=s,this.path=a.path,this.size=a.size,this._remaining=a.size},warn:fstream.warn,error:fstream.error});