//  Underscore.string
//  (c) 2010 Esa-Matti Suuronen <esa-matti aet suuronen dot org>
//  Underscore.string is freely distributable under the terms of the MIT license.
//  Documentation: https://github.com/epeli/underscore.string
//  Some code is borrowed from MooTools and Alexandru Marasteanu.
//  Version '2.3.2'

// Copyright (c) Alexandru Marasteanu <alexaholic [at) gmail (dot] com>

!function(e,n){"use strict";function r(e,n){var r,t,u=e.toLowerCase();for(n=[].concat(n),r=0;r<n.length;r+=1)if(t=n[r]){if(t.test&&t.test(e))return!0;if(t.toLowerCase()===u)return!0}}var t,u,i,l=n.prototype.trim,o=n.prototype.trimRight,a=n.prototype.trimLeft,c=function(e){return 1*e||0},s=function(e,n){if(1>n)return"";for(var r="";n>0;)1&n&&(r+=e),n>>=1,e+=e;return r},f=[].slice,p=function(e){return null==e?"\\s":e.source?e.source:"["+i.escapeRegExp(e)+"]"},h={lt:"<",gt:">",quot:'"',amp:"&",apos:"'"},g={};for(t in h)g[h[t]]=t;g["'"]="#39",u=function(){function e(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}var r=s,t=function(){return t.cache.hasOwnProperty(arguments[0])||(t.cache[arguments[0]]=t.parse(arguments[0])),t.format.call(null,t.cache[arguments[0]],arguments)};return t.format=function(t,i){var l,o,a,c,s,f,p,h=1,g=t.length,d="",m=[];for(o=0;g>o;o++)if(d=e(t[o]),"string"===d)m.push(t[o]);else if("array"===d){if(c=t[o],c[2])for(l=i[h],a=0;a<c[2].length;a++){if(!l.hasOwnProperty(c[2][a]))throw Error(u('[_.sprintf] property "%s" does not exist',c[2][a]));l=l[c[2][a]]}else l=c[1]?i[c[1]]:i[h++];if(/[^s]/.test(c[8])&&"number"!=e(l))throw Error(u("[_.sprintf] expecting number but found %s",e(l)));switch(c[8]){case"b":l=l.toString(2);break;case"c":l=n.fromCharCode(l);break;case"d":l=parseInt(l,10);break;case"e":l=c[7]?l.toExponential(c[7]):l.toExponential();break;case"f":l=c[7]?parseFloat(l).toFixed(c[7]):parseFloat(l);break;case"o":l=l.toString(8);break;case"s":l=(l=n(l))&&c[7]?l.substring(0,c[7]):l;break;case"u":l=Math.abs(l);break;case"x":l=l.toString(16);break;case"X":l=l.toString(16).toUpperCase()}l=/[def]/.test(c[8])&&c[3]&&l>=0?"+"+l:l,f=c[4]?"0"==c[4]?"0":c[4].charAt(1):" ",p=c[6]-n(l).length,s=c[6]?r(f,p):"",m.push(c[5]?l+s:s+l)}return m.join("")},t.cache={},t.parse=function(e){for(var n,r,t,u=e,i=[],l=[],o=0;u;){if(null!==(i=/^[^\x25]+/.exec(u)))l.push(i[0]);else if(null!==(i=/^\x25{2}/.exec(u)))l.push("%");else{if(null===(i=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(u)))throw Error("[_.sprintf] huh?");if(i[2]){if(o|=1,n=[],r=i[2],t=[],null===(t=/^([a-z_][a-z_\d]*)/i.exec(r)))throw Error("[_.sprintf] huh?");for(n.push(t[1]);""!==(r=r.substring(t[0].length));)if(null!==(t=/^\.([a-z_][a-z_\d]*)/i.exec(r)))n.push(t[1]);else{if(null===(t=/^\[(\d+)\]/.exec(r)))throw Error("[_.sprintf] huh?");n.push(t[1])}i[2]=n}else o|=2;if(3===o)throw Error("[_.sprintf] mixing positional and named placeholders is not (yet) supported");l.push(i)}u=u.substring(i[0].length)}return l},t}(),i={VERSION:"2.3.0",isBlank:function(e){return null==e&&(e=""),/^\s*$/.test(e)},stripTags:function(e){return null==e?"":n(e).replace(/<\/?[^>]+>/g,"")},capitalize:function(e){return e=null==e?"":n(e),e.charAt(0).toUpperCase()+e.slice(1)},chop:function(e,r){return null==e?[]:(e=n(e),r=~~r,r>0?e.match(RegExp(".{1,"+r+"}","g")):[e])},clean:function(e){return i.strip(e).replace(/\s+/g," ")},count:function(e,r){if(null==e||null==r)return 0;e=n(e),r=n(r);for(var t=0,u=0,i=r.length;;){if(u=e.indexOf(r,u),-1===u)break;t++,u+=i}return t},chars:function(e){return null==e?[]:n(e).split("")},swapCase:function(e){return null==e?"":n(e).replace(/\S/g,function(e){return e===e.toUpperCase()?e.toLowerCase():e.toUpperCase()})},escapeHTML:function(e){return null==e?"":n(e).replace(/[&<>"']/g,function(e){return"&"+g[e]+";"})},unescapeHTML:function(e){return null==e?"":n(e).replace(/\&([^;]+);/g,function(e,r){var t;return r in h?h[r]:(t=r.match(/^#x([\da-fA-F]+)$/))?n.fromCharCode(parseInt(t[1],16)):(t=r.match(/^#(\d+)$/))?n.fromCharCode(~~t[1]):e})},escapeRegExp:function(e){return null==e?"":n(e).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")},splice:function(e,n,r,t){var u=i.chars(e);return u.splice(~~n,~~r,t),u.join("")},insert:function(e,n,r){return i.splice(e,n,0,r)},include:function(e,r){return""===r?!0:null==e?!1:-1!==n(e).indexOf(r)},join:function(){var e=f.call(arguments),n=e.shift();return null==n&&(n=""),e.join(n)},lines:function(e){return null==e?[]:n(e).split("\n")},reverse:function(e){return i.chars(e).reverse().join("")},startsWith:function(e,r){return""===r?!0:null==e||null==r?!1:(e=n(e),r=n(r),e.length>=r.length&&e.slice(0,r.length)===r)},endsWith:function(e,r){return""===r?!0:null==e||null==r?!1:(e=n(e),r=n(r),e.length>=r.length&&e.slice(e.length-r.length)===r)},succ:function(e){return null==e?"":(e=n(e),e.slice(0,-1)+n.fromCharCode(e.charCodeAt(e.length-1)+1))},titleize:function(e){return null==e?"":(e=n(e).toLowerCase(),e.replace(/(?:^|\s|-)\S/g,function(e){return e.toUpperCase()}))},camelize:function(e){return i.trim(e).replace(/[-_\s]+(.)?/g,function(e,n){return n?n.toUpperCase():""})},underscored:function(e){return i.trim(e).replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()},dasherize:function(e){return i.trim(e).replace(/([A-Z])/g,"-$1").replace(/[-_\s]+/g,"-").toLowerCase()},classify:function(e){return i.titleize(n(e).replace(/[\W_]/g," ")).replace(/\s/g,"")},humanize:function(e){return i.capitalize(i.underscored(e).replace(/_id$/,"").replace(/_/g," "))},trim:function(e,r){return null==e?"":!r&&l?l.call(e):(r=p(r),n(e).replace(RegExp("^"+r+"+|"+r+"+$","g"),""))},ltrim:function(e,r){return null==e?"":!r&&a?a.call(e):(r=p(r),n(e).replace(RegExp("^"+r+"+"),""))},rtrim:function(e,r){return null==e?"":!r&&o?o.call(e):(r=p(r),n(e).replace(RegExp(r+"+$"),""))},truncate:function(e,r,t){return null==e?"":(e=n(e),t=t||"...",r=~~r,e.length>r?e.slice(0,r)+t:e)},prune:function(e,r,t){if(null==e)return"";if(e=n(e),r=~~r,t=null!=t?n(t):"...",e.length<=r)return e;var u=function(e){return e.toUpperCase()!==e.toLowerCase()?"A":" "},l=e.slice(0,r+1).replace(/.(?=\W*\w*$)/g,u);return l=l.slice(l.length-2).match(/\w\w/)?l.replace(/\s*\S+$/,""):i.rtrim(l.slice(0,l.length-1)),(l+t).length>e.length?e:e.slice(0,l.length)+t},words:function(e,n){return i.isBlank(e)?[]:i.trim(e,n).split(n||/\s+/)},pad:function(e,r,t,u){e=null==e?"":n(e),r=~~r;var i=0;switch(t?t.length>1&&(t=t.charAt(0)):t=" ",u){case"right":return i=r-e.length,e+s(t,i);case"both":return i=r-e.length,s(t,Math.ceil(i/2))+e+s(t,Math.floor(i/2));default:return i=r-e.length,s(t,i)+e}},lpad:function(e,n,r){return i.pad(e,n,r)},rpad:function(e,n,r){return i.pad(e,n,r,"right")},lrpad:function(e,n,r){return i.pad(e,n,r,"both")},sprintf:u,vsprintf:function(e,n){return n.unshift(e),u.apply(null,n)},toNumber:function(e,n){return e?(e=i.trim(e),e.match(/^-?\d+(?:\.\d+)?$/)?c(c(e).toFixed(~~n)):0/0):0},numberFormat:function(e,n,r,t){if(isNaN(e)||null==e)return"";e=e.toFixed(~~n),t="string"==typeof t?t:",";var u=e.split("."),i=u[0],l=u[1]?(r||".")+u[1]:"";return i.replace(/(\d)(?=(?:\d{3})+$)/g,"$1"+t)+l},strRight:function(e,r){if(null==e)return"";e=n(e),r=null!=r?n(r):r;var t=r?e.indexOf(r):-1;return~t?e.slice(t+r.length,e.length):e},strRightBack:function(e,r){if(null==e)return"";e=n(e),r=null!=r?n(r):r;var t=r?e.lastIndexOf(r):-1;return~t?e.slice(t+r.length,e.length):e},strLeft:function(e,r){if(null==e)return"";e=n(e),r=null!=r?n(r):r;var t=r?e.indexOf(r):-1;return~t?e.slice(0,t):e},strLeftBack:function(e,n){if(null==e)return"";e+="",n=null!=n?""+n:n;var r=e.lastIndexOf(n);return~r?e.slice(0,r):e},toSentence:function(e,n,r,t){n=n||", ",r=r||" and ";var u=e.slice(),l=u.pop();return e.length>2&&t&&(r=i.rtrim(n)+r),u.length?u.join(n)+r+l:l},toSentenceSerial:function(){var e=f.call(arguments);return e[3]=!0,i.toSentence.apply(i,e)},slugify:function(e){if(null==e)return"";var r="ąàáäâãåæăćęèéëêìíïîłńòóöôõøśșțùúüûñçżź",t="aaaaaaaaaceeeeeiiiilnoooooosstuuuunczz",u=RegExp(p(r),"g");return e=n(e).toLowerCase().replace(u,function(e){var n=r.indexOf(e);return t.charAt(n)||"-"}),i.dasherize(e.replace(/[^\w\s-]/g,""))},surround:function(e,n){return[n,e,n].join("")},quote:function(e,n){return i.surround(e,n||'"')},unquote:function(e,n){return n=n||'"',e[0]===n&&e[e.length-1]===n?e.slice(1,e.length-1):e},exports:function(){var e,n={};for(e in this)this.hasOwnProperty(e)&&!e.match(/^(?:include|contains|reverse)$/)&&(n[e]=this[e]);return n},repeat:function(e,r,t){if(null==e)return"";if(r=~~r,null==t)return s(n(e),r);for(var u=[];r>0;u[--r]=e);return u.join(t)},naturalCmp:function(e,r){var t,u,i,l,o,a,c,s,f;if(e==r)return 0;if(!e)return-1;if(!r)return 1;for(t=/(\.\d+)|(\d+)|(\D+)/g,u=n(e).toLowerCase().match(t),i=n(r).toLowerCase().match(t),l=Math.min(u.length,i.length),o=0;l>o;o++)if(a=u[o],c=i[o],a!==c)return s=parseInt(a,10),!isNaN(s)&&(f=parseInt(c,10),!isNaN(f)&&s-f)?s-f:c>a?-1:1;return u.length===i.length?u.length-i.length:r>e?-1:1},levenshtein:function(e,r){var t,u,i,l,o;if(null==e&&null==r)return 0;if(null==e)return n(r).length;if(null==r)return n(e).length;for(e=n(e),r=n(r),i=[],l=0;l<=r.length;l++)for(o=0;o<=e.length;o++)u=l&&o?e.charAt(o-1)===r.charAt(l-1)?t:Math.min(i[o],i[o-1],t)+1:l+o,t=i[o],i[o]=u;return i.pop()},toBoolean:function(e,n,t){return"number"==typeof e&&(e=""+e),"string"!=typeof e?!!e:(e=i.trim(e),r(e,n||["true","1"])?!0:r(e,t||["false","0"])?!1:void 0)}},i.strip=i.trim,i.lstrip=i.ltrim,i.rstrip=i.rtrim,i.center=i.lrpad,i.rjust=i.lpad,i.ljust=i.rpad,i.contains=i.include,i.q=i.quote,i.toBool=i.toBoolean,"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(module.exports=i),exports._s=i),"function"==typeof define&&define.amd&&define("underscore.string",[],function(){return i}),e._=e._||{},e._.string=e._.str=i}(this,String);