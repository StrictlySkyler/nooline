!function(){function e(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function t(){return 1}function n(u){function o(e,t){var n=p[e];return n&&(v&&Date.now()-n.now>v?(a(n),h||(n=void 0)):t&&i(n),n&&(n=n.value)),n}function i(e){l(e),e.lu=m++,g[e.lu]=e}function f(){for(;m>d&&b>c;)a(g[d])}function l(e){for(delete g[e.lu];m>d&&!g[d];)d++}function a(e){e&&(y&&y(e.key,e.value),b-=e.length,w--,delete p[e.key],l(e))}var c,s,h,v,y,p,g,m,d,b,w;return this instanceof n?("number"==typeof u&&(c=u,u={max:c}),u||(u={}),c=u.max,s=u.length||t,"function"!=typeof s&&(s=t),(!c||"number"!=typeof c||0>=c)&&(c=1/0),h=u.stale||!1,v=u.maxAge||null,y=u.dispose,p=Object.create(null),g=Object.create(null),m=0,d=0,b=0,w=0,Object.defineProperty(this,"max",{set:function(e){(!e||"number"!=typeof e||0>=e)&&(e=1/0),c=e,b>c&&f()},get:function(){return c},enumerable:!0}),Object.defineProperty(this,"lengthCalculator",{set:function(e){var n;if("function"!=typeof e){s=t,b=w;for(n in p)p[n].length=1}else{s=e,b=0;for(n in p)p[n].length=s(p[n].value),b+=p[n].length}b>c&&f()},get:function(){return s},enumerable:!0}),Object.defineProperty(this,"length",{get:function(){return b},enumerable:!0}),Object.defineProperty(this,"itemCount",{get:function(){return w},enumerable:!0}),this.forEach=function(e,t){var n,r,u;for(t=t||this,n=0,r=m-1;r>=0&&w>n;r--)g[r]&&(n++,u=g[r],v&&Date.now()-u.now>v&&(a(u),h||(u=void 0)),u&&e.call(t,u.value,u.key,this))},this.keys=function(){var e,t,n=Array(w),r=0;for(e=m-1;e>=0&&w>r;e--)g[e]&&(t=g[e],n[r++]=t.key);return n},this.values=function(){var e,t,n=Array(w),r=0;for(e=m-1;e>=0&&w>r;e--)g[e]&&(t=g[e],n[r++]=t.value);return n},this.reset=function(){if(y)for(var e in p)y(e,p[e].value);p={},g={},d=0,m=0,b=0,w=0},this.dump=function(){return p},this.dumpLru=function(){return g},this.set=function(t,n){var u,o,i;return e(p,t)?(y&&y(t,p[t].value),v&&(p[t].now=Date.now()),p[t].value=n,this.get(t),!0):(u=s(n),o=v?Date.now():0,i=new r(t,n,m++,u,o),i.length>c?(y&&y(t,n),!1):(b+=i.length,g[i.lu]=p[t]=i,w++,b>c&&f(),!0))},this.has=function(t){if(!e(p,t))return!1;var n=p[t];return v&&Date.now()-n.now>v?!1:!0},this.get=function(e){return o(e,!0)},this.peek=function(e){return o(e,!1)},this.del=function(e){a(p[e])},void 0):new n(u)}function r(e,t,n,r,u){this.key=e,this.value=t,this.lu=n,this.length=r,this.now=u}"object"==typeof module&&module.exports?module.exports=n:this.LRUCache=n}();