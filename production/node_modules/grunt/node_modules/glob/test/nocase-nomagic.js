var fs=null,test=null.test,glob=null;test("mock fs",function(t){function n(t){var n;switch(t.toLowerCase()){case"/tmp":case"/tmp/":n={isDirectory:function(){return!0}};break;case"/tmp/a":n={isDirectory:function(){return!1}}}return n}function s(t){var n;switch(t.toLowerCase()){case"/tmp":case"/tmp/":n=["a","A"];break;case"/":n=["tmp","tMp","tMP","TMP"]}return n}var a=fs.stat,c=fs.statSync,e=fs.readdir,o=fs.readdirSync;fs.stat=function(t,s){var c=n(t);c?process.nextTick(function(){s(null,c)}):a.call(fs,t,s)},fs.statSync=function(t){return n(t)||c.call(fs,t)},fs.readdir=function(t,n){var a=s(t);a?process.nextTick(function(){n(null,a)}):e.call(fs,t,n)},fs.readdirSync=function(t){return s(t)||o.call(fs,t)},t.pass("mocked"),t.end()}),test("nocase, nomagic",function(t){var n=2,s=["/TMP/A","/TMP/a","/tMP/A","/tMP/a","/tMp/A","/tMp/a","/tmp/A","/tmp/a"];glob("/tmp/a",{nocase:!0},function(a,c){if(a)throw a;t.same(c.sort(),s),0===--n&&t.end()}),glob("/tmp/A",{nocase:!0},function(a,c){if(a)throw a;t.same(c.sort(),s),0===--n&&t.end()})}),test("nocase, with some magic",function(t){t.plan(2);var n=["/TMP/A","/TMP/a","/tMP/A","/tMP/a","/tMp/A","/tMp/a","/tmp/A","/tmp/a"];glob("/tmp/*",{nocase:!0},function(s,a){if(s)throw s;t.same(a.sort(),n)}),glob("/tmp/*",{nocase:!0},function(s,a){if(s)throw s;t.same(a.sort(),n)})});