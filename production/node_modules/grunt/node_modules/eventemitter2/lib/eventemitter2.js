!function(e){function t(){this._events={},this._conf&&s.call(this,this._conf)}function s(e){e&&(this._conf=e,e.delimiter&&(this.delimiter=e.delimiter),e.maxListeners&&(this._events.maxListeners=e.maxListeners),e.wildcard&&(this.wildcard=e.wildcard),e.newListener&&(this.newListener=e.newListener),this.wildcard&&(this.listenerTree={}))}function i(e){this._events={},this.newListener=!1,s.call(this,e)}function n(e,t,s,i){if(!s)return[];var r,l,o,h,a,f,c,u=[],_=t.length,p=t[i],d=t[i+1];if(i===_&&s._listeners){if("function"==typeof s._listeners)return e&&e.push(s._listeners),[s];for(r=0,l=s._listeners.length;l>r;r++)e&&e.push(s._listeners[r]);return[s]}if("*"===p||"**"===p||s[p]){if("*"===p){for(o in s)"_listeners"!==o&&s.hasOwnProperty(o)&&(u=u.concat(n(e,t,s[o],i+1)));return u}if("**"===p){c=i+1===_||i+2===_&&"*"===d,c&&s._listeners&&(u=u.concat(n(e,t,s,_)));for(o in s)"_listeners"!==o&&s.hasOwnProperty(o)&&("*"===o||"**"===o?(s[o]._listeners&&!c&&(u=u.concat(n(e,t,s[o],_))),u=u.concat(n(e,t,s[o],i))):u=o===d?u.concat(n(e,t,s[o],i+2)):u.concat(n(e,t,s[o],i)));return u}u=u.concat(n(e,t,s[p],i+1))}if(h=s["*"],h&&n(e,t,h,i+1),a=s["**"])if(_>i){a._listeners&&n(e,t,a,_);for(o in a)"_listeners"!==o&&a.hasOwnProperty(o)&&(o===d?n(e,t,a[o],i+2):o===p?n(e,t,a[o],i+1):(f={},f[o]=a[o],n(e,t,{"**":f},i+1)))}else a._listeners?n(e,t,a,_):a["*"]&&a["*"]._listeners&&n(e,t,a["*"],_);return u}function r(e,t){var s,i,n,r,h;for(e="string"==typeof e?e.split(this.delimiter):e.slice(),s=0,i=e.length;i>s+1;s++)if("**"===e[s]&&"**"===e[s+1])return;for(n=this.listenerTree,r=e.shift();r;){if(n[r]||(n[r]={}),n=n[r],0===e.length)return n._listeners?"function"==typeof n._listeners?n._listeners=[n._listeners,t]:l(n._listeners)&&(n._listeners.push(t),n._listeners.warned||(h=o,undefined!==this._events.maxListeners&&(h=this._events.maxListeners),h>0&&n._listeners.length>h&&(n._listeners.warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",n._listeners.length),console.trace()))):n._listeners=t,!0;r=e.shift()}return!0}var l=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},o=10;i.prototype.delimiter=".",i.prototype.setMaxListeners=function(e){this._events||t.call(this),this._events.maxListeners=e,this._conf||(this._conf={}),this._conf.maxListeners=e},i.prototype.event="",i.prototype.once=function(e,t){return this.many(e,1,t),this},i.prototype.many=function(e,t,s){function i(){0===--t&&n.off(e,i),s.apply(this,arguments)}var n=this;if("function"!=typeof s)throw Error("many only accepts instances of Function");return i._origin=s,this.on(e,i),n},i.prototype.emit=function(){var e,s,i,r,l,o,h;if(this._events||t.call(this),e=arguments[0],"newListener"===e&&!this.newListener&&!this._events.newListener)return!1;if(this._all){for(s=arguments.length,i=Array(s-1),r=1;s>r;r++)i[r-1]=arguments[r];for(r=0,s=this._all.length;s>r;r++)this.event=e,this._all[r].apply(this,i)}if("error"===e&&!(this._all||this._events.error||this.wildcard&&this.listenerTree.error))throw arguments[1]instanceof Error?arguments[1]:Error("Uncaught, unspecified 'error' event.");if(this.wildcard?(l=[],o="string"==typeof e?e.split(this.delimiter):e.slice(),n.call(this,l,o,this.listenerTree,0)):l=this._events[e],"function"==typeof l){if(this.event=e,1===arguments.length)l.call(this);else if(arguments.length>1)switch(arguments.length){case 2:l.call(this,arguments[1]);break;case 3:l.call(this,arguments[1],arguments[2]);break;default:for(s=arguments.length,i=Array(s-1),r=1;s>r;r++)i[r-1]=arguments[r];l.apply(this,i)}return!0}if(l){for(s=arguments.length,i=Array(s-1),r=1;s>r;r++)i[r-1]=arguments[r];for(h=l.slice(),r=0,s=h.length;s>r;r++)this.event=e,h[r].apply(this,i);return h.length>0||this._all}return this._all},i.prototype.on=function(e,s){if("function"==typeof e)return this.onAny(e),this;if("function"!=typeof s)throw Error("on only accepts instances of Function");if(this._events||t.call(this),this.emit("newListener",e,s),this.wildcard)return r.call(this,e,s),this;if(this._events[e]){if("function"==typeof this._events[e])this._events[e]=[this._events[e],s];else if(l(this._events[e])&&(this._events[e].push(s),!this._events[e].warned)){var i=o;undefined!==this._events.maxListeners&&(i=this._events.maxListeners),i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),console.trace())}}else this._events[e]=s;return this},i.prototype.onAny=function(e){if(this._all||(this._all=[]),"function"!=typeof e)throw Error("onAny only accepts instances of Function");return this._all.push(e),this},i.prototype.addListener=i.prototype.on,i.prototype.off=function(e,t){var s,i,r,o,h,a,f,c;if("function"!=typeof t)throw Error("removeListener only takes instances of Function");if(i=[],this.wildcard)r="string"==typeof e?e.split(this.delimiter):e.slice(),i=n.call(this,null,r,this.listenerTree,0);else{if(!this._events[e])return this;s=this._events[e],i.push({_listeners:s})}for(o=0;o<i.length;o++){if(h=i[o],s=h._listeners,l(s)){for(a=-1,f=0,c=s.length;c>f;f++)if(s[f]===t||s[f].listener&&s[f].listener===t||s[f]._origin&&s[f]._origin===t){a=f;break}if(0>a)continue;return this.wildcard?h._listeners.splice(a,1):this._events[e].splice(a,1),0===s.length&&(this.wildcard?delete h._listeners:delete this._events[e]),this}(s===t||s.listener&&s.listener===t||s._origin&&s._origin===t)&&(this.wildcard?delete h._listeners:delete this._events[e])}return this},i.prototype.offAny=function(e){var t,s=0,i=0;if(e&&this._all&&this._all.length>0){for(t=this._all,s=0,i=t.length;i>s;s++)if(e===t[s])return t.splice(s,1),this}else this._all=[];return this},i.prototype.removeListener=i.prototype.off,i.prototype.removeAllListeners=function(e){var s,i,r,l;if(0===arguments.length)return!this._events||t.call(this),this;if(this.wildcard)for(s="string"==typeof e?e.split(this.delimiter):e.slice(),i=n.call(this,null,s,this.listenerTree,0),r=0;r<i.length;r++)l=i[r],l._listeners=null;else{if(!this._events[e])return this;this._events[e]=null}return this},i.prototype.listeners=function(e){var s,i;return this.wildcard?(s=[],i="string"==typeof e?e.split(this.delimiter):e.slice(),n.call(this,s,i,this.listenerTree,0),s):(this._events||t.call(this),this._events[e]||(this._events[e]=[]),l(this._events[e])||(this._events[e]=[this._events[e]]),this._events[e])},i.prototype.listenersAny=function(){return this._all?this._all:[]},"function"==typeof define&&define.amd?define([],function(){return i}):e.EventEmitter2=i}("undefined"!=typeof process&&void 0!==process.title&&"undefined"!=typeof exports?exports:window);