$(document).ready(function(){module("Functions"),test("functions: bind",function(){var t,n,e={name:"moe"},o=function(t){return"name: "+(this.name||t)},i=_.bind(o,e);equals(i(),"name: moe","can bind a function to a context"),i=_(o).bind(e),equals(i(),"name: moe","can do OO-style binding"),i=_.bind(o,null,"curly"),equals(i(),"name: curly","can bind without specifying a context"),o=function(t,n){return t+": "+n},o=_.bind(o,this,"hello"),equals(o("moe"),"hello: moe","the function was partially applied in advance"),o=_.bind(o,this,"curly"),equals(o(),"hello: curly","the function was completely applied in advance"),o=function(t,n,e){return t+": "+n+" "+e},o=_.bind(o,this,"hello","moe","curly"),equals(o(),"hello: moe curly","the function was partially applied in advance and can accept multiple arguments"),o=function(t,n){equals(this,t,n)},_.bind(o,0,0,"can bind a function to `0`")(),_.bind(o,"","","can bind a function to an empty string")(),_.bind(o,!1,!1,"can bind a function to `false`")(),t=function(){return this},n=_.bind(t,{hello:"moe curly"}),equal((new n).hello,void 0,"function should not be bound to the context, to comply with ECMAScript 5"),equal(n().hello,"moe curly","When called without the new operator, it's OK to be bound to the context")}),test("functions: bindAll",function(){var t={name:"curly"},n={name:"moe",getName:function(){return"name: "+this.name},sayHi:function(){return"hi: "+this.name}};t.getName=n.getName,_.bindAll(n,"getName","sayHi"),t.sayHi=n.sayHi,equals(t.getName(),"name: curly","unbound function is bound to current object"),equals(t.sayHi(),"hi: moe","bound function is still bound to original object"),t={name:"curly"},n={name:"moe",getName:function(){return"name: "+this.name},sayHi:function(){return"hi: "+this.name}},_.bindAll(n),t.sayHi=n.sayHi,equals(t.sayHi(),"hi: moe","calling bindAll with no arguments binds all functions to the object")}),test("functions: memoize",function(){var t,n,e=function(t){return 2>t?t:e(t-1)+e(t-2)},o=_.memoize(e);equals(e(10),55,"a memoized version of fibonacci produces identical results"),equals(o(10),55,"a memoized version of fibonacci produces identical results"),t=function(t){return t},n=_.memoize(t),equals(t("toString"),"toString","checks hasOwnProperty"),equals(n("toString"),"toString","checks hasOwnProperty")}),asyncTest("functions: delay",2,function(){var t=!1;_.delay(function(){t=!0},100),setTimeout(function(){ok(!t,"didn't delay the function quite yet")},50),setTimeout(function(){ok(t,"delayed the function"),start()},150)}),asyncTest("functions: defer",1,function(){var t=!1;_.defer(function(n){t=n},!0),_.delay(function(){ok(t,"deferred the function"),start()},50)}),asyncTest("functions: throttle",2,function(){var t=0,n=function(){t++},e=_.throttle(n,100);e(),e(),e(),setTimeout(e,70),setTimeout(e,120),setTimeout(e,140),setTimeout(e,190),setTimeout(e,220),setTimeout(e,240),_.delay(function(){ok(1==t,"incr was called immediately")},30),_.delay(function(){ok(4==t,"incr was throttled"),start()},400)}),asyncTest("functions: throttle arguments",2,function(){var t=0,n=function(n){t=n},e=_.throttle(n,100);e(1),e(2),e(3),setTimeout(function(){e(4)},120),setTimeout(function(){e(5)},140),setTimeout(function(){e(6)},250),_.delay(function(){equals(t,1,"updated to latest value")},40),_.delay(function(){equals(t,6,"updated to latest value"),start()},400)}),asyncTest("functions: throttle once",1,function(){var t=0,n=function(){t++},e=_.throttle(n,100);e(),_.delay(function(){ok(1==t,"incr was called once"),start()},220)}),asyncTest("functions: throttle twice",1,function(){var t=0,n=function(){t++},e=_.throttle(n,100);e(),e(),_.delay(function(){ok(2==t,"incr was called twice"),start()},220)}),asyncTest("functions: debounce",1,function(){var t=0,n=function(){t++},e=_.debounce(n,50);e(),e(),e(),setTimeout(e,30),setTimeout(e,60),setTimeout(e,90),setTimeout(e,120),setTimeout(e,150),_.delay(function(){ok(1==t,"incr was debounced"),start()},220)}),test("functions: once",function(){var t=0,n=_.once(function(){t++});n(),n(),equals(t,1)}),test("functions: wrap",function(){var t,n,e,o,i,u=function(t){return"hi: "+t},a=_.wrap(u,function(t,n){return t(n)+" "+n.split("").reverse().join("")});equals(a("moe"),"hi: moe eom","wrapped the saluation function"),t=function(){return"Hello "},n={name:"Moe"},n.hi=_.wrap(t,function(t){return t()+this.name}),equals(n.hi(),"Hello Moe"),e=function(){},o=_.wrap(e,function(){return Array.prototype.slice.call(arguments,0)}),i=o(["whats","your"],"vector","victor"),same(i,[e,["whats","your"],"vector","victor"])}),test("functions: compose",function(){var t=function(t){return"hi: "+t},n=function(t){return t+"!"},e=_.compose(n,t);equals(e("moe"),"hi: moe!","can compose a function that takes another"),e=_.compose(t,n),equals(e("moe"),"hi: moe!","in this case, the functions are also commutative")}),test("functions: after",function(){var t=function(t,n){for(var e=0,o=_.after(t,function(){e++});n--;)o();return e};equals(t(5,5),1,"after(N) should fire after being called N times"),equals(t(5,4),0,"after(N) should not fire unless called N times"),equals(t(0,0),1,"after(0) should fire immediately")})});