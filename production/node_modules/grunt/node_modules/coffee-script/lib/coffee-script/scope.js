(function(){var t,e,r,n;n=null,e=n.extend,r=n.last,exports.Scope=t=function(){function t(e,r,n){this.parent=e,this.expressions=r,this.method=n,this.variables=[{name:"arguments",type:"arguments"}],this.positions={},this.parent||(t.root=this)}return t.root=null,t.prototype.add=function(t,e,r){return this.shared&&!r?this.parent.add(t,e,r):Object.prototype.hasOwnProperty.call(this.positions,t)?this.variables[this.positions[t]].type=e:this.positions[t]=this.variables.push({name:t,type:e})-1},t.prototype.namedMethod=function(){return this.method.name||!this.parent?this.method:this.parent.namedMethod()},t.prototype.find=function(t){return this.check(t)?!0:(this.add(t,"var"),!1)},t.prototype.parameter=function(t){return this.shared&&this.parent.check(t,!0)?void 0:this.add(t,"param")},t.prototype.check=function(t){var e;return!!(this.type(t)||(null!=(e=this.parent)?e.check(t):void 0))},t.prototype.temporary=function(t,e){return t.length>1?"_"+t+(e>1?e-1:""):"_"+(e+parseInt(t,36)).toString(36).replace(/\d/g,"a")},t.prototype.type=function(t){var e,r,n,a;for(a=this.variables,r=0,n=a.length;n>r;r++)if(e=a[r],e.name===t)return e.type;return null},t.prototype.freeVariable=function(t,e){var r,n;for(null==e&&(e=!0),r=0;this.check(n=this.temporary(t,r));)r++;return e&&this.add(n,"var",!0),n},t.prototype.assign=function(t,e){return this.add(t,{value:e,assigned:!0},!0),this.hasAssignments=!0},t.prototype.hasDeclarations=function(){return!!this.declaredVariables().length},t.prototype.declaredVariables=function(){var t,e,r,n,a,s;for(t=[],e=[],s=this.variables,n=0,a=s.length;a>n;n++)r=s[n],"var"===r.type&&("_"===r.name.charAt(0)?e:t).push(r.name);return t.sort().concat(e.sort())},t.prototype.assignedVariables=function(){var t,e,r,n,a;for(n=this.variables,a=[],e=0,r=n.length;r>e;e++)t=n[e],t.type.assigned&&a.push(""+t.name+" = "+t.type.value);return a},t}()}).call(this);