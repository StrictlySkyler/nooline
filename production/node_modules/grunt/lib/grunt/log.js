/*
 * grunt
 * http://gruntjs.com/
 *
 * Copyright (c) 2013 "Cowboy" Ben Alman
 * Licensed under the MIT license.
 * https://github.com/gruntjs/grunt/blob/master/LICENSE-MIT
 */

"use strict";function markup(r){return r=r||"",r=r.replace(/(\s|^)_(\S|\S[\s\S]+?\S)_(?=[\s,.!?]|$)/g,"$1"+"$2".underline),r=r.replace(/(\s|^)\*(\S|\S[\s\S]+?\S)\*(?=[\s,.!?]|$)/g,"$1"+"$2".bold)}function format(r){return r=[].slice.call(r,0),r.length>0&&(r[0]=r[0]+""),util.format.apply(util,r)}function write(r){r=r||"",log.muted||suppressOutput||(hasLogged=!0,grunt.option("no-color")&&(r=colors.stripColors(r)),process.stdout.write(markup(r)))}function writeln(r){r=r||"",write(r+"\n")}var suppressOutput,hasLogged,grunt=null,util=null,log=module.exports={},colors=null;log.initColors=function(){var r=grunt.util;grunt.option("no-color")&&(colors.mode="none",r.hooker.hook(console,"log",function(){var o=r.toArray(arguments);return r.hooker.filter(this,o.map(function(o){return"string"===r.kindOf(o)?colors.stripColors(o):o}))}))},log.muted=!1,log.write=function(){return write(format(arguments)),log},log.writeln=function(){return writeln(format(arguments)),log},log.warn=function(){var r=format(arguments);return arguments.length>0?writeln(">> ".red+grunt.util._.trim(r).replace(/\n/g,"\n>> ".red)):writeln("ERROR".red),log},log.error=function(){return grunt.fail.errorcount++,log.warn.apply(log,arguments),log},log.ok=function(){var r=format(arguments);return arguments.length>0?writeln(">> ".green+grunt.util._.trim(r).replace(/\n/g,"\n>> ".green)):writeln("OK".green),log},log.errorlns=function(){var r=format(arguments);return log.error(log.wraptext(77,r)),log},log.oklns=function(){var r=format(arguments);return log.ok(log.wraptext(77,r)),log},log.success=function(){var r=format(arguments);return writeln(r.green),log},log.fail=function(){var r=format(arguments);return writeln(r.red),log},log.header=function(){var r=format(arguments);return hasLogged&&writeln(),writeln(r.underline),log},log.subhead=function(){var r=format(arguments);return hasLogged&&writeln(),writeln(r.bold),log},log.debug=function(){var r=format(arguments);return grunt.option("debug")&&writeln("[D] "+r.magenta),log},log.writetableln=function(r,o){return writeln(log.table(r,o)),log},log.writelns=function(){var r=format(arguments);return writeln(log.wraptext(80,r)),log},log.writeflags=function(r,o){var t;return Array.isArray(r)?t=log.wordlist(r):"object"==typeof r&&r&&(t=log.wordlist(Object.keys(r).map(function(o){var t=r[o];return o+(t===!0?"":"="+JSON.stringify(t))}))),writeln((o||"Flags")+": "+(t||"(none)".cyan)),log},log.verbose={},log.notverbose={},Object.keys(log).filter(function(r){return"function"==typeof log[r]}).forEach(function(r){log.verbose[r]=function(){return suppressOutput=!grunt.option("verbose"),log[r].apply(log,arguments),suppressOutput=!1,log.verbose},log.notverbose[r]=function(){return suppressOutput=grunt.option("verbose"),log[r].apply(log,arguments),suppressOutput=!1,log.notverbose}}),log.verbose.or=log.notverbose,log.notverbose.or=log.verbose,log.wordlist=function(r,o){return o=grunt.util._.defaults(o||{},{separator:", ",color:"cyan"}),r.map(function(r){return o.color?(r+"")[o.color]:r}).join(o.separator)},log.uncolor=function(r){return r.replace(/\x1B\[\d+m/g,"")},log.wraptext=function(r,o){for(var t,n,e,l=[],u=[],g=0;t=o.match(/(?:(\x1B\[\d+m)|\n|(.))([\s\S]*)/);)if(o=t[3],t[1])n=t[1],u.push(t[1]);else{if(t[2]){if(0===g&&n&&u.push(n),u.push(t[2]),g++,r>=g||" "===t[2])continue;e=u.lastIndexOf(" "),o=u.slice(-1===e?e:e+1).join("")+o,u=u.slice(0,e)}l.push(u.join("")),u=[],g=0}return l.push(u.join("")),l.join("\n")},log.table=function(r,o){var t,n=[];return r.forEach(function(r,t){var e=log.wraptext(r,o[t]).split("\n");e.forEach(function(r,o){var e=n[o];e||(e=n[o]=[]),e[t]=r})}),t=[],n.forEach(function(o){var n,e,l,u="";for(e=0;e<o.length;e++)n=o[e]||"",u+=n,l=r[e]-log.uncolor(n).length,l>0&&(u+=grunt.util.repeat(l," "));t.push(u)}),t.join("\n")};