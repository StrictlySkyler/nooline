/*!
 * socket.io-node
 * Copyright(c) 2011 LearnBoost <dev@learnboost.com>
 * MIT Licensed
 */

function Hub(t){this.hub=hub.createHub(t||"socket.io-clusterhub"),Store.call(this,{}),this.setMaxListeners(0)}function Client(t,e){Store.Client.call(this,t.hub,e)}var Store=null,assert=null,hub=null;exports=module.exports=Hub,Hub.Client=Client,Hub.prototype.__proto__=Store.prototype,Hub.prototype.publish=function(){var t=Array.prototype.slice.call(arguments);this.hub.broadcast.apply(this.hub,t),this.emit.apply(this,["publish"].concat(t))},Hub.prototype.subscribe=function(t,e,i){e&&this.hub.on(t,e),i&&i(),this.emit("subscribe",t,e,i)},Hub.prototype.unsubscribe=function(t,e){e&&this.hub.off(t,e),this.emit("unsubscribe",t,e)},Hub.prototype.destroy=function(){Store.prototype.destroy.call(this),this.hub.die()},Client.prototype.__proto__=Store.Client,Client.prototype.get=function(t,e){return this.store.hget(this.id,t,function(){var t=Array.prototype.slice.call(arguments);e.apply(this,[null].concat(t))}),this},Client.prototype.set=function(t,e,i){return this.store.hset(this.id,t,e,function(){var t=Array.prototype.slice.call(arguments);i.apply(this,[null].concat(t))}),this},Client.prototype.del=function(t,e){return this.store.hdel(this.id,t,function(){var t=Array.prototype.slice.call(arguments);e.apply(this,[null].concat(t))}),this},Client.prototype.has=function(t,e){return this.store.hexists(this.id,t,function(){var t=Array.prototype.slice.call(arguments);e.apply(this,[null].concat(t))}),this},Client.prototype.destroy=function(t){return"number"!=typeof t?this.store.del(this.id):this.store.expire(this.id,t),this};